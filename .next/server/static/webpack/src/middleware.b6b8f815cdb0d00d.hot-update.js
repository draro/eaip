"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("src/middleware",{

/***/ "(middleware)/./node_modules/next/dist/esm/server/web/adapter.js":
/*!**********************************************************!*\
  !*** ./node_modules/next/dist/esm/server/web/adapter.js ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   NextRequestHint: () => (/* binding */ NextRequestHint),\n/* harmony export */   adapter: () => (/* binding */ adapter)\n/* harmony export */ });\n/* harmony import */ var _error__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./error */ \"(middleware)/./node_modules/next/dist/esm/server/web/error.js\");\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils */ \"(middleware)/./node_modules/next/dist/esm/server/web/utils.js\");\n/* harmony import */ var _spec_extension_fetch_event__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./spec-extension/fetch-event */ \"(middleware)/./node_modules/next/dist/esm/server/web/spec-extension/fetch-event.js\");\n/* harmony import */ var _spec_extension_request__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./spec-extension/request */ \"(middleware)/./node_modules/next/dist/esm/server/web/spec-extension/request.js\");\n/* harmony import */ var _spec_extension_response__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./spec-extension/response */ \"(middleware)/./node_modules/next/dist/esm/server/web/spec-extension/response.js\");\n/* harmony import */ var _shared_lib_router_utils_relativize_url__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../shared/lib/router/utils/relativize-url */ \"(middleware)/./node_modules/next/dist/esm/shared/lib/router/utils/relativize-url.js\");\n/* harmony import */ var _next_url__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./next-url */ \"(middleware)/./node_modules/next/dist/esm/server/web/next-url.js\");\n/* harmony import */ var _internal_utils__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../internal-utils */ \"(middleware)/./node_modules/next/dist/esm/server/internal-utils.js\");\n/* harmony import */ var _shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../shared/lib/router/utils/app-paths */ \"(middleware)/./node_modules/next/dist/esm/shared/lib/router/utils/app-paths.js\");\n/* harmony import */ var _client_components_app_router_headers__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../client/components/app-router-headers */ \"(middleware)/./node_modules/next/dist/esm/client/components/app-router-headers.js\");\n/* harmony import */ var _lib_constants__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../lib/constants */ \"(middleware)/./node_modules/next/dist/esm/lib/constants.js\");\n/* harmony import */ var _globals__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./globals */ \"(middleware)/./node_modules/next/dist/esm/server/web/globals.js\");\n/* harmony import */ var _async_storage_request_async_storage_wrapper__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../async-storage/request-async-storage-wrapper */ \"(middleware)/./node_modules/next/dist/esm/server/async-storage/request-async-storage-wrapper.js\");\n/* harmony import */ var _client_components_request_async_storage_external__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../client/components/request-async-storage.external */ \"(shared)/./node_modules/next/dist/esm/client/components/request-async-storage.external.js\");\n/* harmony import */ var _lib_trace_tracer__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../lib/trace/tracer */ \"(middleware)/./node_modules/next/dist/esm/server/lib/trace/tracer.js\");\n/* harmony import */ var _lib_trace_constants__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../lib/trace/constants */ \"(middleware)/./node_modules/next/dist/esm/server/lib/trace/constants.js\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nclass NextRequestHint extends _spec_extension_request__WEBPACK_IMPORTED_MODULE_3__.NextRequest {\n    constructor(params){\n        super(params.input, params.init);\n        this.sourcePage = params.page;\n    }\n    get request() {\n        throw new _error__WEBPACK_IMPORTED_MODULE_0__.PageSignatureError({\n            page: this.sourcePage\n        });\n    }\n    respondWith() {\n        throw new _error__WEBPACK_IMPORTED_MODULE_0__.PageSignatureError({\n            page: this.sourcePage\n        });\n    }\n    waitUntil() {\n        throw new _error__WEBPACK_IMPORTED_MODULE_0__.PageSignatureError({\n            page: this.sourcePage\n        });\n    }\n}\nconst headersGetter = {\n    keys: (headers)=>Array.from(headers.keys()),\n    get: (headers, key)=>headers.get(key) ?? undefined\n};\nlet propagator = (request, fn)=>{\n    const tracer = (0,_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_14__.getTracer)();\n    return tracer.withPropagatedContext(request.headers, fn, headersGetter);\n};\nlet testApisIntercepted = false;\nfunction ensureTestApisIntercepted() {\n    if (!testApisIntercepted) {\n        testApisIntercepted = true;\n        if (process.env.NEXT_PRIVATE_TEST_PROXY === \"true\") {\n            const { interceptTestApis, wrapRequestHandler } = __webpack_require__(/*! next/dist/experimental/testmode/server-edge */ \"(middleware)/./node_modules/next/dist/experimental/testmode/server-edge.js\");\n            interceptTestApis();\n            propagator = wrapRequestHandler(propagator);\n        }\n    }\n}\nasync function adapter(params) {\n    ensureTestApisIntercepted();\n    await (0,_globals__WEBPACK_IMPORTED_MODULE_11__.ensureInstrumentationRegistered)();\n    // TODO-APP: use explicit marker for this\n    const isEdgeRendering = typeof self.__BUILD_MANIFEST !== \"undefined\";\n    const prerenderManifest = typeof self.__PRERENDER_MANIFEST === \"string\" ? JSON.parse(self.__PRERENDER_MANIFEST) : undefined;\n    params.request.url = (0,_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_8__.normalizeRscURL)(params.request.url);\n    const requestUrl = new _next_url__WEBPACK_IMPORTED_MODULE_6__.NextURL(params.request.url, {\n        headers: params.request.headers,\n        nextConfig: params.request.nextConfig\n    });\n    // Iterator uses an index to keep track of the current iteration. Because of deleting and appending below we can't just use the iterator.\n    // Instead we use the keys before iteration.\n    const keys = [\n        ...requestUrl.searchParams.keys()\n    ];\n    for (const key of keys){\n        const value = requestUrl.searchParams.getAll(key);\n        if (key !== _lib_constants__WEBPACK_IMPORTED_MODULE_10__.NEXT_QUERY_PARAM_PREFIX && key.startsWith(_lib_constants__WEBPACK_IMPORTED_MODULE_10__.NEXT_QUERY_PARAM_PREFIX)) {\n            const normalizedKey = key.substring(_lib_constants__WEBPACK_IMPORTED_MODULE_10__.NEXT_QUERY_PARAM_PREFIX.length);\n            requestUrl.searchParams.delete(normalizedKey);\n            for (const val of value){\n                requestUrl.searchParams.append(normalizedKey, val);\n            }\n            requestUrl.searchParams.delete(key);\n        }\n    }\n    // Ensure users only see page requests, never data requests.\n    const buildId = requestUrl.buildId;\n    requestUrl.buildId = \"\";\n    const isDataReq = params.request.headers[\"x-nextjs-data\"];\n    if (isDataReq && requestUrl.pathname === \"/index\") {\n        requestUrl.pathname = \"/\";\n    }\n    const requestHeaders = (0,_utils__WEBPACK_IMPORTED_MODULE_1__.fromNodeOutgoingHttpHeaders)(params.request.headers);\n    const flightHeaders = new Map();\n    // Parameters should only be stripped for middleware\n    if (!isEdgeRendering) {\n        for (const param of _client_components_app_router_headers__WEBPACK_IMPORTED_MODULE_9__.FLIGHT_PARAMETERS){\n            const key = param.toString().toLowerCase();\n            const value = requestHeaders.get(key);\n            if (value) {\n                flightHeaders.set(key, requestHeaders.get(key));\n                requestHeaders.delete(key);\n            }\n        }\n    }\n    const normalizeUrl =  false ? 0 : requestUrl;\n    const request = new NextRequestHint({\n        page: params.page,\n        // Strip internal query parameters off the request.\n        input: (0,_internal_utils__WEBPACK_IMPORTED_MODULE_7__.stripInternalSearchParams)(normalizeUrl, true).toString(),\n        init: {\n            body: params.request.body,\n            geo: params.request.geo,\n            headers: requestHeaders,\n            ip: params.request.ip,\n            method: params.request.method,\n            nextConfig: params.request.nextConfig,\n            signal: params.request.signal\n        }\n    });\n    /**\n   * This allows to identify the request as a data request. The user doesn't\n   * need to know about this property neither use it. We add it for testing\n   * purposes.\n   */ if (isDataReq) {\n        Object.defineProperty(request, \"__isData\", {\n            enumerable: false,\n            value: true\n        });\n    }\n    if (!globalThis.__incrementalCache && params.IncrementalCache) {\n        globalThis.__incrementalCache = new params.IncrementalCache({\n            appDir: true,\n            fetchCache: true,\n            minimalMode: \"development\" !== \"development\",\n            fetchCacheKeyPrefix: \"\",\n            dev: \"development\" === \"development\",\n            requestHeaders: params.request.headers,\n            requestProtocol: \"https\",\n            getPrerenderManifest: ()=>{\n                return {\n                    version: -1,\n                    routes: {},\n                    dynamicRoutes: {},\n                    notFoundRoutes: [],\n                    preview: {\n                        previewModeId: \"development-id\"\n                    }\n                };\n            }\n        });\n    }\n    const event = new _spec_extension_fetch_event__WEBPACK_IMPORTED_MODULE_2__.NextFetchEvent({\n        request,\n        page: params.page\n    });\n    let response;\n    let cookiesFromResponse;\n    response = await propagator(request, ()=>{\n        // we only care to make async storage available for middleware\n        const isMiddleware = params.page === \"/middleware\" || params.page === \"/src/middleware\";\n        if (isMiddleware) {\n            return (0,_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_14__.getTracer)().trace(_lib_trace_constants__WEBPACK_IMPORTED_MODULE_15__.MiddlewareSpan.execute, {\n                spanName: `middleware ${request.method} ${request.nextUrl.pathname}`,\n                attributes: {\n                    \"http.target\": request.nextUrl.pathname,\n                    \"http.method\": request.method\n                }\n            }, ()=>_async_storage_request_async_storage_wrapper__WEBPACK_IMPORTED_MODULE_12__.RequestAsyncStorageWrapper.wrap(_client_components_request_async_storage_external__WEBPACK_IMPORTED_MODULE_13__.requestAsyncStorage, {\n                    req: request,\n                    renderOpts: {\n                        onUpdateCookies: (cookies)=>{\n                            cookiesFromResponse = cookies;\n                        },\n                        // @ts-expect-error: TODO: investigate why previewProps isn't on RenderOpts\n                        previewProps: (prerenderManifest == null ? void 0 : prerenderManifest.preview) || {\n                            previewModeId: \"development-id\",\n                            previewModeEncryptionKey: \"\",\n                            previewModeSigningKey: \"\"\n                        }\n                    }\n                }, ()=>params.handler(request, event)));\n        }\n        return params.handler(request, event);\n    });\n    // check if response is a Response object\n    if (response && !(response instanceof Response)) {\n        throw new TypeError(\"Expected an instance of Response to be returned\");\n    }\n    if (response && cookiesFromResponse) {\n        response.headers.set(\"set-cookie\", cookiesFromResponse);\n    }\n    /**\n   * For rewrites we must always include the locale in the final pathname\n   * so we re-create the NextURL forcing it to include it when the it is\n   * an internal rewrite. Also we make sure the outgoing rewrite URL is\n   * a data URL if the request was a data request.\n   */ const rewrite = response == null ? void 0 : response.headers.get(\"x-middleware-rewrite\");\n    if (response && rewrite && !isEdgeRendering) {\n        const rewriteUrl = new _next_url__WEBPACK_IMPORTED_MODULE_6__.NextURL(rewrite, {\n            forceLocale: true,\n            headers: params.request.headers,\n            nextConfig: params.request.nextConfig\n        });\n        if (true) {\n            if (rewriteUrl.host === request.nextUrl.host) {\n                rewriteUrl.buildId = buildId || rewriteUrl.buildId;\n                response.headers.set(\"x-middleware-rewrite\", String(rewriteUrl));\n            }\n        }\n        /**\n     * When the request is a data request we must show if there was a rewrite\n     * with an internal header so the client knows which component to load\n     * from the data request.\n     */ const relativizedRewrite = (0,_shared_lib_router_utils_relativize_url__WEBPACK_IMPORTED_MODULE_5__.relativizeURL)(String(rewriteUrl), String(requestUrl));\n        if (isDataReq && // if the rewrite is external and external rewrite\n        // resolving config is enabled don't add this header\n        // so the upstream app can set it instead\n        !( false && 0)) {\n            response.headers.set(\"x-nextjs-rewrite\", relativizedRewrite);\n        }\n    }\n    /**\n   * For redirects we will not include the locale in case when it is the\n   * default and we must also make sure the outgoing URL is a data one if\n   * the incoming request was a data request.\n   */ const redirect = response == null ? void 0 : response.headers.get(\"Location\");\n    if (response && redirect && !isEdgeRendering) {\n        const redirectURL = new _next_url__WEBPACK_IMPORTED_MODULE_6__.NextURL(redirect, {\n            forceLocale: false,\n            headers: params.request.headers,\n            nextConfig: params.request.nextConfig\n        });\n        /**\n     * Responses created from redirects have immutable headers so we have\n     * to clone the response to be able to modify it.\n     */ response = new Response(response.body, response);\n        if (true) {\n            if (redirectURL.host === request.nextUrl.host) {\n                redirectURL.buildId = buildId || redirectURL.buildId;\n                response.headers.set(\"Location\", String(redirectURL));\n            }\n        }\n        /**\n     * When the request is a data request we can't use the location header as\n     * it may end up with CORS error. Instead we map to an internal header so\n     * the client knows the destination.\n     */ if (isDataReq) {\n            response.headers.delete(\"Location\");\n            response.headers.set(\"x-nextjs-redirect\", (0,_shared_lib_router_utils_relativize_url__WEBPACK_IMPORTED_MODULE_5__.relativizeURL)(String(redirectURL), String(requestUrl)));\n        }\n    }\n    const finalResponse = response ? response : _spec_extension_response__WEBPACK_IMPORTED_MODULE_4__.NextResponse.next();\n    // Flight headers are not overridable / removable so they are applied at the end.\n    const middlewareOverrideHeaders = finalResponse.headers.get(\"x-middleware-override-headers\");\n    const overwrittenHeaders = [];\n    if (middlewareOverrideHeaders) {\n        for (const [key, value] of flightHeaders){\n            finalResponse.headers.set(`x-middleware-request-${key}`, value);\n            overwrittenHeaders.push(key);\n        }\n        if (overwrittenHeaders.length > 0) {\n            finalResponse.headers.set(\"x-middleware-override-headers\", middlewareOverrideHeaders + \",\" + overwrittenHeaders.join(\",\"));\n        }\n    }\n    return {\n        response: finalResponse,\n        waitUntil: Promise.all(event[_spec_extension_fetch_event__WEBPACK_IMPORTED_MODULE_2__.waitUntilSymbol]),\n        fetchMetrics: request.fetchMetrics\n    };\n}\n\n//# sourceMappingURL=adapter.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKG1pZGRsZXdhcmUpLy4vbm9kZV9tb2R1bGVzL25leHQvZGlzdC9lc20vc2VydmVyL3dlYi9hZGFwdGVyLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUE2QztBQUNTO0FBQ1E7QUFDUDtBQUNFO0FBQ29CO0FBQ2Q7QUFDMUI7QUFDeUI7QUFDWTtBQUNLO0FBQ2pCO0FBQ0Y7QUFDZ0M7QUFDQztBQUM3QztBQUNRO0FBQ2pELDhCQUE4QixnRUFBVztBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLHNEQUFrQjtBQUNwQztBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0Esa0JBQWtCLHNEQUFrQjtBQUNwQztBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0Esa0JBQWtCLHNEQUFrQjtBQUNwQztBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQiw2REFBUztBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQix3Q0FBd0MsRUFBRSxtQkFBTyxDQUFDLCtIQUE2QztBQUNuSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBLFVBQVUsMEVBQStCO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QixtRkFBZTtBQUN4QywyQkFBMkIsOENBQU87QUFDbEM7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixvRUFBdUIsbUJBQW1CLG9FQUF1QjtBQUNyRixnREFBZ0Qsb0VBQXVCO0FBQ3ZFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsbUVBQTJCO0FBQ3REO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixvRkFBaUI7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QixNQUE4QyxHQUFHLENBQTJCO0FBQ3JHO0FBQ0E7QUFDQTtBQUNBLGVBQWUsMEVBQXlCO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsYUFBb0I7QUFDN0MsaUNBQWlDLEVBQXlDO0FBQzFFLGlCQUFpQixhQUFvQjtBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEJBQThCO0FBQzlCLHFDQUFxQztBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxzQkFBc0IsdUVBQWM7QUFDcEM7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsNkRBQVMsU0FBUyxpRUFBYztBQUNuRCx3Q0FBd0MsZ0JBQWdCLEVBQUUseUJBQXlCO0FBQ25GO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxNQUFNLHFHQUEwQixNQUFNLG1HQUFtQjtBQUN0RTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0IsOENBQU87QUFDdEM7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULFlBQVksSUFBK0M7QUFDM0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DLHNGQUFhO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBLFVBQVUsTUFBc0QsSUFBSSxDQUF5QztBQUM3RztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0MsOENBQU87QUFDdkM7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSxJQUErQztBQUMzRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0RBQXNELHNGQUFhO0FBQ25FO0FBQ0E7QUFDQSxnREFBZ0Qsa0VBQVk7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhEQUE4RCxJQUFJO0FBQ2xFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQ0FBcUMsd0VBQWU7QUFDcEQ7QUFDQTtBQUNBOztBQUVBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uL25vZGVfbW9kdWxlcy9uZXh0L2Rpc3QvZXNtL3NlcnZlci93ZWIvYWRhcHRlci5qcz9lZTE3Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhZ2VTaWduYXR1cmVFcnJvciB9IGZyb20gXCIuL2Vycm9yXCI7XG5pbXBvcnQgeyBmcm9tTm9kZU91dGdvaW5nSHR0cEhlYWRlcnMgfSBmcm9tIFwiLi91dGlsc1wiO1xuaW1wb3J0IHsgTmV4dEZldGNoRXZlbnQgfSBmcm9tIFwiLi9zcGVjLWV4dGVuc2lvbi9mZXRjaC1ldmVudFwiO1xuaW1wb3J0IHsgTmV4dFJlcXVlc3QgfSBmcm9tIFwiLi9zcGVjLWV4dGVuc2lvbi9yZXF1ZXN0XCI7XG5pbXBvcnQgeyBOZXh0UmVzcG9uc2UgfSBmcm9tIFwiLi9zcGVjLWV4dGVuc2lvbi9yZXNwb25zZVwiO1xuaW1wb3J0IHsgcmVsYXRpdml6ZVVSTCB9IGZyb20gXCIuLi8uLi9zaGFyZWQvbGliL3JvdXRlci91dGlscy9yZWxhdGl2aXplLXVybFwiO1xuaW1wb3J0IHsgd2FpdFVudGlsU3ltYm9sIH0gZnJvbSBcIi4vc3BlYy1leHRlbnNpb24vZmV0Y2gtZXZlbnRcIjtcbmltcG9ydCB7IE5leHRVUkwgfSBmcm9tIFwiLi9uZXh0LXVybFwiO1xuaW1wb3J0IHsgc3RyaXBJbnRlcm5hbFNlYXJjaFBhcmFtcyB9IGZyb20gXCIuLi9pbnRlcm5hbC11dGlsc1wiO1xuaW1wb3J0IHsgbm9ybWFsaXplUnNjVVJMIH0gZnJvbSBcIi4uLy4uL3NoYXJlZC9saWIvcm91dGVyL3V0aWxzL2FwcC1wYXRoc1wiO1xuaW1wb3J0IHsgRkxJR0hUX1BBUkFNRVRFUlMgfSBmcm9tIFwiLi4vLi4vY2xpZW50L2NvbXBvbmVudHMvYXBwLXJvdXRlci1oZWFkZXJzXCI7XG5pbXBvcnQgeyBORVhUX1FVRVJZX1BBUkFNX1BSRUZJWCB9IGZyb20gXCIuLi8uLi9saWIvY29uc3RhbnRzXCI7XG5pbXBvcnQgeyBlbnN1cmVJbnN0cnVtZW50YXRpb25SZWdpc3RlcmVkIH0gZnJvbSBcIi4vZ2xvYmFsc1wiO1xuaW1wb3J0IHsgUmVxdWVzdEFzeW5jU3RvcmFnZVdyYXBwZXIgfSBmcm9tIFwiLi4vYXN5bmMtc3RvcmFnZS9yZXF1ZXN0LWFzeW5jLXN0b3JhZ2Utd3JhcHBlclwiO1xuaW1wb3J0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSB9IGZyb20gXCIuLi8uLi9jbGllbnQvY29tcG9uZW50cy9yZXF1ZXN0LWFzeW5jLXN0b3JhZ2UuZXh0ZXJuYWxcIjtcbmltcG9ydCB7IGdldFRyYWNlciB9IGZyb20gXCIuLi9saWIvdHJhY2UvdHJhY2VyXCI7XG5pbXBvcnQgeyBNaWRkbGV3YXJlU3BhbiB9IGZyb20gXCIuLi9saWIvdHJhY2UvY29uc3RhbnRzXCI7XG5leHBvcnQgY2xhc3MgTmV4dFJlcXVlc3RIaW50IGV4dGVuZHMgTmV4dFJlcXVlc3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtcyl7XG4gICAgICAgIHN1cGVyKHBhcmFtcy5pbnB1dCwgcGFyYW1zLmluaXQpO1xuICAgICAgICB0aGlzLnNvdXJjZVBhZ2UgPSBwYXJhbXMucGFnZTtcbiAgICB9XG4gICAgZ2V0IHJlcXVlc3QoKSB7XG4gICAgICAgIHRocm93IG5ldyBQYWdlU2lnbmF0dXJlRXJyb3Ioe1xuICAgICAgICAgICAgcGFnZTogdGhpcy5zb3VyY2VQYWdlXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICByZXNwb25kV2l0aCgpIHtcbiAgICAgICAgdGhyb3cgbmV3IFBhZ2VTaWduYXR1cmVFcnJvcih7XG4gICAgICAgICAgICBwYWdlOiB0aGlzLnNvdXJjZVBhZ2VcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHdhaXRVbnRpbCgpIHtcbiAgICAgICAgdGhyb3cgbmV3IFBhZ2VTaWduYXR1cmVFcnJvcih7XG4gICAgICAgICAgICBwYWdlOiB0aGlzLnNvdXJjZVBhZ2VcbiAgICAgICAgfSk7XG4gICAgfVxufVxuY29uc3QgaGVhZGVyc0dldHRlciA9IHtcbiAgICBrZXlzOiAoaGVhZGVycyk9PkFycmF5LmZyb20oaGVhZGVycy5rZXlzKCkpLFxuICAgIGdldDogKGhlYWRlcnMsIGtleSk9PmhlYWRlcnMuZ2V0KGtleSkgPz8gdW5kZWZpbmVkXG59O1xubGV0IHByb3BhZ2F0b3IgPSAocmVxdWVzdCwgZm4pPT57XG4gICAgY29uc3QgdHJhY2VyID0gZ2V0VHJhY2VyKCk7XG4gICAgcmV0dXJuIHRyYWNlci53aXRoUHJvcGFnYXRlZENvbnRleHQocmVxdWVzdC5oZWFkZXJzLCBmbiwgaGVhZGVyc0dldHRlcik7XG59O1xubGV0IHRlc3RBcGlzSW50ZXJjZXB0ZWQgPSBmYWxzZTtcbmZ1bmN0aW9uIGVuc3VyZVRlc3RBcGlzSW50ZXJjZXB0ZWQoKSB7XG4gICAgaWYgKCF0ZXN0QXBpc0ludGVyY2VwdGVkKSB7XG4gICAgICAgIHRlc3RBcGlzSW50ZXJjZXB0ZWQgPSB0cnVlO1xuICAgICAgICBpZiAocHJvY2Vzcy5lbnYuTkVYVF9QUklWQVRFX1RFU1RfUFJPWFkgPT09IFwidHJ1ZVwiKSB7XG4gICAgICAgICAgICBjb25zdCB7IGludGVyY2VwdFRlc3RBcGlzLCB3cmFwUmVxdWVzdEhhbmRsZXIgfSA9IHJlcXVpcmUoXCJuZXh0L2Rpc3QvZXhwZXJpbWVudGFsL3Rlc3Rtb2RlL3NlcnZlci1lZGdlXCIpO1xuICAgICAgICAgICAgaW50ZXJjZXB0VGVzdEFwaXMoKTtcbiAgICAgICAgICAgIHByb3BhZ2F0b3IgPSB3cmFwUmVxdWVzdEhhbmRsZXIocHJvcGFnYXRvcik7XG4gICAgICAgIH1cbiAgICB9XG59XG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gYWRhcHRlcihwYXJhbXMpIHtcbiAgICBlbnN1cmVUZXN0QXBpc0ludGVyY2VwdGVkKCk7XG4gICAgYXdhaXQgZW5zdXJlSW5zdHJ1bWVudGF0aW9uUmVnaXN0ZXJlZCgpO1xuICAgIC8vIFRPRE8tQVBQOiB1c2UgZXhwbGljaXQgbWFya2VyIGZvciB0aGlzXG4gICAgY29uc3QgaXNFZGdlUmVuZGVyaW5nID0gdHlwZW9mIHNlbGYuX19CVUlMRF9NQU5JRkVTVCAhPT0gXCJ1bmRlZmluZWRcIjtcbiAgICBjb25zdCBwcmVyZW5kZXJNYW5pZmVzdCA9IHR5cGVvZiBzZWxmLl9fUFJFUkVOREVSX01BTklGRVNUID09PSBcInN0cmluZ1wiID8gSlNPTi5wYXJzZShzZWxmLl9fUFJFUkVOREVSX01BTklGRVNUKSA6IHVuZGVmaW5lZDtcbiAgICBwYXJhbXMucmVxdWVzdC51cmwgPSBub3JtYWxpemVSc2NVUkwocGFyYW1zLnJlcXVlc3QudXJsKTtcbiAgICBjb25zdCByZXF1ZXN0VXJsID0gbmV3IE5leHRVUkwocGFyYW1zLnJlcXVlc3QudXJsLCB7XG4gICAgICAgIGhlYWRlcnM6IHBhcmFtcy5yZXF1ZXN0LmhlYWRlcnMsXG4gICAgICAgIG5leHRDb25maWc6IHBhcmFtcy5yZXF1ZXN0Lm5leHRDb25maWdcbiAgICB9KTtcbiAgICAvLyBJdGVyYXRvciB1c2VzIGFuIGluZGV4IHRvIGtlZXAgdHJhY2sgb2YgdGhlIGN1cnJlbnQgaXRlcmF0aW9uLiBCZWNhdXNlIG9mIGRlbGV0aW5nIGFuZCBhcHBlbmRpbmcgYmVsb3cgd2UgY2FuJ3QganVzdCB1c2UgdGhlIGl0ZXJhdG9yLlxuICAgIC8vIEluc3RlYWQgd2UgdXNlIHRoZSBrZXlzIGJlZm9yZSBpdGVyYXRpb24uXG4gICAgY29uc3Qga2V5cyA9IFtcbiAgICAgICAgLi4ucmVxdWVzdFVybC5zZWFyY2hQYXJhbXMua2V5cygpXG4gICAgXTtcbiAgICBmb3IgKGNvbnN0IGtleSBvZiBrZXlzKXtcbiAgICAgICAgY29uc3QgdmFsdWUgPSByZXF1ZXN0VXJsLnNlYXJjaFBhcmFtcy5nZXRBbGwoa2V5KTtcbiAgICAgICAgaWYgKGtleSAhPT0gTkVYVF9RVUVSWV9QQVJBTV9QUkVGSVggJiYga2V5LnN0YXJ0c1dpdGgoTkVYVF9RVUVSWV9QQVJBTV9QUkVGSVgpKSB7XG4gICAgICAgICAgICBjb25zdCBub3JtYWxpemVkS2V5ID0ga2V5LnN1YnN0cmluZyhORVhUX1FVRVJZX1BBUkFNX1BSRUZJWC5sZW5ndGgpO1xuICAgICAgICAgICAgcmVxdWVzdFVybC5zZWFyY2hQYXJhbXMuZGVsZXRlKG5vcm1hbGl6ZWRLZXkpO1xuICAgICAgICAgICAgZm9yIChjb25zdCB2YWwgb2YgdmFsdWUpe1xuICAgICAgICAgICAgICAgIHJlcXVlc3RVcmwuc2VhcmNoUGFyYW1zLmFwcGVuZChub3JtYWxpemVkS2V5LCB2YWwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmVxdWVzdFVybC5zZWFyY2hQYXJhbXMuZGVsZXRlKGtleSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLy8gRW5zdXJlIHVzZXJzIG9ubHkgc2VlIHBhZ2UgcmVxdWVzdHMsIG5ldmVyIGRhdGEgcmVxdWVzdHMuXG4gICAgY29uc3QgYnVpbGRJZCA9IHJlcXVlc3RVcmwuYnVpbGRJZDtcbiAgICByZXF1ZXN0VXJsLmJ1aWxkSWQgPSBcIlwiO1xuICAgIGNvbnN0IGlzRGF0YVJlcSA9IHBhcmFtcy5yZXF1ZXN0LmhlYWRlcnNbXCJ4LW5leHRqcy1kYXRhXCJdO1xuICAgIGlmIChpc0RhdGFSZXEgJiYgcmVxdWVzdFVybC5wYXRobmFtZSA9PT0gXCIvaW5kZXhcIikge1xuICAgICAgICByZXF1ZXN0VXJsLnBhdGhuYW1lID0gXCIvXCI7XG4gICAgfVxuICAgIGNvbnN0IHJlcXVlc3RIZWFkZXJzID0gZnJvbU5vZGVPdXRnb2luZ0h0dHBIZWFkZXJzKHBhcmFtcy5yZXF1ZXN0LmhlYWRlcnMpO1xuICAgIGNvbnN0IGZsaWdodEhlYWRlcnMgPSBuZXcgTWFwKCk7XG4gICAgLy8gUGFyYW1ldGVycyBzaG91bGQgb25seSBiZSBzdHJpcHBlZCBmb3IgbWlkZGxld2FyZVxuICAgIGlmICghaXNFZGdlUmVuZGVyaW5nKSB7XG4gICAgICAgIGZvciAoY29uc3QgcGFyYW0gb2YgRkxJR0hUX1BBUkFNRVRFUlMpe1xuICAgICAgICAgICAgY29uc3Qga2V5ID0gcGFyYW0udG9TdHJpbmcoKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgY29uc3QgdmFsdWUgPSByZXF1ZXN0SGVhZGVycy5nZXQoa2V5KTtcbiAgICAgICAgICAgIGlmICh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGZsaWdodEhlYWRlcnMuc2V0KGtleSwgcmVxdWVzdEhlYWRlcnMuZ2V0KGtleSkpO1xuICAgICAgICAgICAgICAgIHJlcXVlc3RIZWFkZXJzLmRlbGV0ZShrZXkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGNvbnN0IG5vcm1hbGl6ZVVybCA9IHByb2Nlc3MuZW52Ll9fTkVYVF9OT19NSURETEVXQVJFX1VSTF9OT1JNQUxJWkUgPyBuZXcgVVJMKHBhcmFtcy5yZXF1ZXN0LnVybCkgOiByZXF1ZXN0VXJsO1xuICAgIGNvbnN0IHJlcXVlc3QgPSBuZXcgTmV4dFJlcXVlc3RIaW50KHtcbiAgICAgICAgcGFnZTogcGFyYW1zLnBhZ2UsXG4gICAgICAgIC8vIFN0cmlwIGludGVybmFsIHF1ZXJ5IHBhcmFtZXRlcnMgb2ZmIHRoZSByZXF1ZXN0LlxuICAgICAgICBpbnB1dDogc3RyaXBJbnRlcm5hbFNlYXJjaFBhcmFtcyhub3JtYWxpemVVcmwsIHRydWUpLnRvU3RyaW5nKCksXG4gICAgICAgIGluaXQ6IHtcbiAgICAgICAgICAgIGJvZHk6IHBhcmFtcy5yZXF1ZXN0LmJvZHksXG4gICAgICAgICAgICBnZW86IHBhcmFtcy5yZXF1ZXN0LmdlbyxcbiAgICAgICAgICAgIGhlYWRlcnM6IHJlcXVlc3RIZWFkZXJzLFxuICAgICAgICAgICAgaXA6IHBhcmFtcy5yZXF1ZXN0LmlwLFxuICAgICAgICAgICAgbWV0aG9kOiBwYXJhbXMucmVxdWVzdC5tZXRob2QsXG4gICAgICAgICAgICBuZXh0Q29uZmlnOiBwYXJhbXMucmVxdWVzdC5uZXh0Q29uZmlnLFxuICAgICAgICAgICAgc2lnbmFsOiBwYXJhbXMucmVxdWVzdC5zaWduYWxcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIC8qKlxuICAgKiBUaGlzIGFsbG93cyB0byBpZGVudGlmeSB0aGUgcmVxdWVzdCBhcyBhIGRhdGEgcmVxdWVzdC4gVGhlIHVzZXIgZG9lc24ndFxuICAgKiBuZWVkIHRvIGtub3cgYWJvdXQgdGhpcyBwcm9wZXJ0eSBuZWl0aGVyIHVzZSBpdC4gV2UgYWRkIGl0IGZvciB0ZXN0aW5nXG4gICAqIHB1cnBvc2VzLlxuICAgKi8gaWYgKGlzRGF0YVJlcSkge1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkocmVxdWVzdCwgXCJfX2lzRGF0YVwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgICAgIHZhbHVlOiB0cnVlXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAoIWdsb2JhbFRoaXMuX19pbmNyZW1lbnRhbENhY2hlICYmIHBhcmFtcy5JbmNyZW1lbnRhbENhY2hlKSB7XG4gICAgICAgIGdsb2JhbFRoaXMuX19pbmNyZW1lbnRhbENhY2hlID0gbmV3IHBhcmFtcy5JbmNyZW1lbnRhbENhY2hlKHtcbiAgICAgICAgICAgIGFwcERpcjogdHJ1ZSxcbiAgICAgICAgICAgIGZldGNoQ2FjaGU6IHRydWUsXG4gICAgICAgICAgICBtaW5pbWFsTW9kZTogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwiZGV2ZWxvcG1lbnRcIixcbiAgICAgICAgICAgIGZldGNoQ2FjaGVLZXlQcmVmaXg6IHByb2Nlc3MuZW52Ll9fTkVYVF9GRVRDSF9DQUNIRV9LRVlfUFJFRklYLFxuICAgICAgICAgICAgZGV2OiBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gXCJkZXZlbG9wbWVudFwiLFxuICAgICAgICAgICAgcmVxdWVzdEhlYWRlcnM6IHBhcmFtcy5yZXF1ZXN0LmhlYWRlcnMsXG4gICAgICAgICAgICByZXF1ZXN0UHJvdG9jb2w6IFwiaHR0cHNcIixcbiAgICAgICAgICAgIGdldFByZXJlbmRlck1hbmlmZXN0OiAoKT0+e1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHZlcnNpb246IC0xLFxuICAgICAgICAgICAgICAgICAgICByb3V0ZXM6IHt9LFxuICAgICAgICAgICAgICAgICAgICBkeW5hbWljUm91dGVzOiB7fSxcbiAgICAgICAgICAgICAgICAgICAgbm90Rm91bmRSb3V0ZXM6IFtdLFxuICAgICAgICAgICAgICAgICAgICBwcmV2aWV3OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcmV2aWV3TW9kZUlkOiBcImRldmVsb3BtZW50LWlkXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBldmVudCA9IG5ldyBOZXh0RmV0Y2hFdmVudCh7XG4gICAgICAgIHJlcXVlc3QsXG4gICAgICAgIHBhZ2U6IHBhcmFtcy5wYWdlXG4gICAgfSk7XG4gICAgbGV0IHJlc3BvbnNlO1xuICAgIGxldCBjb29raWVzRnJvbVJlc3BvbnNlO1xuICAgIHJlc3BvbnNlID0gYXdhaXQgcHJvcGFnYXRvcihyZXF1ZXN0LCAoKT0+e1xuICAgICAgICAvLyB3ZSBvbmx5IGNhcmUgdG8gbWFrZSBhc3luYyBzdG9yYWdlIGF2YWlsYWJsZSBmb3IgbWlkZGxld2FyZVxuICAgICAgICBjb25zdCBpc01pZGRsZXdhcmUgPSBwYXJhbXMucGFnZSA9PT0gXCIvbWlkZGxld2FyZVwiIHx8IHBhcmFtcy5wYWdlID09PSBcIi9zcmMvbWlkZGxld2FyZVwiO1xuICAgICAgICBpZiAoaXNNaWRkbGV3YXJlKSB7XG4gICAgICAgICAgICByZXR1cm4gZ2V0VHJhY2VyKCkudHJhY2UoTWlkZGxld2FyZVNwYW4uZXhlY3V0ZSwge1xuICAgICAgICAgICAgICAgIHNwYW5OYW1lOiBgbWlkZGxld2FyZSAke3JlcXVlc3QubWV0aG9kfSAke3JlcXVlc3QubmV4dFVybC5wYXRobmFtZX1gLFxuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJodHRwLnRhcmdldFwiOiByZXF1ZXN0Lm5leHRVcmwucGF0aG5hbWUsXG4gICAgICAgICAgICAgICAgICAgIFwiaHR0cC5tZXRob2RcIjogcmVxdWVzdC5tZXRob2RcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCAoKT0+UmVxdWVzdEFzeW5jU3RvcmFnZVdyYXBwZXIud3JhcChyZXF1ZXN0QXN5bmNTdG9yYWdlLCB7XG4gICAgICAgICAgICAgICAgICAgIHJlcTogcmVxdWVzdCxcbiAgICAgICAgICAgICAgICAgICAgcmVuZGVyT3B0czoge1xuICAgICAgICAgICAgICAgICAgICAgICAgb25VcGRhdGVDb29raWVzOiAoY29va2llcyk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb29raWVzRnJvbVJlc3BvbnNlID0gY29va2llcztcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBAdHMtZXhwZWN0LWVycm9yOiBUT0RPOiBpbnZlc3RpZ2F0ZSB3aHkgcHJldmlld1Byb3BzIGlzbid0IG9uIFJlbmRlck9wdHNcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpZXdQcm9wczogKHByZXJlbmRlck1hbmlmZXN0ID09IG51bGwgPyB2b2lkIDAgOiBwcmVyZW5kZXJNYW5pZmVzdC5wcmV2aWV3KSB8fCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJldmlld01vZGVJZDogXCJkZXZlbG9wbWVudC1pZFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpZXdNb2RlRW5jcnlwdGlvbktleTogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmV2aWV3TW9kZVNpZ25pbmdLZXk6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sICgpPT5wYXJhbXMuaGFuZGxlcihyZXF1ZXN0LCBldmVudCkpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcGFyYW1zLmhhbmRsZXIocmVxdWVzdCwgZXZlbnQpO1xuICAgIH0pO1xuICAgIC8vIGNoZWNrIGlmIHJlc3BvbnNlIGlzIGEgUmVzcG9uc2Ugb2JqZWN0XG4gICAgaWYgKHJlc3BvbnNlICYmICEocmVzcG9uc2UgaW5zdGFuY2VvZiBSZXNwb25zZSkpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkV4cGVjdGVkIGFuIGluc3RhbmNlIG9mIFJlc3BvbnNlIHRvIGJlIHJldHVybmVkXCIpO1xuICAgIH1cbiAgICBpZiAocmVzcG9uc2UgJiYgY29va2llc0Zyb21SZXNwb25zZSkge1xuICAgICAgICByZXNwb25zZS5oZWFkZXJzLnNldChcInNldC1jb29raWVcIiwgY29va2llc0Zyb21SZXNwb25zZSk7XG4gICAgfVxuICAgIC8qKlxuICAgKiBGb3IgcmV3cml0ZXMgd2UgbXVzdCBhbHdheXMgaW5jbHVkZSB0aGUgbG9jYWxlIGluIHRoZSBmaW5hbCBwYXRobmFtZVxuICAgKiBzbyB3ZSByZS1jcmVhdGUgdGhlIE5leHRVUkwgZm9yY2luZyBpdCB0byBpbmNsdWRlIGl0IHdoZW4gdGhlIGl0IGlzXG4gICAqIGFuIGludGVybmFsIHJld3JpdGUuIEFsc28gd2UgbWFrZSBzdXJlIHRoZSBvdXRnb2luZyByZXdyaXRlIFVSTCBpc1xuICAgKiBhIGRhdGEgVVJMIGlmIHRoZSByZXF1ZXN0IHdhcyBhIGRhdGEgcmVxdWVzdC5cbiAgICovIGNvbnN0IHJld3JpdGUgPSByZXNwb25zZSA9PSBudWxsID8gdm9pZCAwIDogcmVzcG9uc2UuaGVhZGVycy5nZXQoXCJ4LW1pZGRsZXdhcmUtcmV3cml0ZVwiKTtcbiAgICBpZiAocmVzcG9uc2UgJiYgcmV3cml0ZSAmJiAhaXNFZGdlUmVuZGVyaW5nKSB7XG4gICAgICAgIGNvbnN0IHJld3JpdGVVcmwgPSBuZXcgTmV4dFVSTChyZXdyaXRlLCB7XG4gICAgICAgICAgICBmb3JjZUxvY2FsZTogdHJ1ZSxcbiAgICAgICAgICAgIGhlYWRlcnM6IHBhcmFtcy5yZXF1ZXN0LmhlYWRlcnMsXG4gICAgICAgICAgICBuZXh0Q29uZmlnOiBwYXJhbXMucmVxdWVzdC5uZXh0Q29uZmlnXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoIXByb2Nlc3MuZW52Ll9fTkVYVF9OT19NSURETEVXQVJFX1VSTF9OT1JNQUxJWkUpIHtcbiAgICAgICAgICAgIGlmIChyZXdyaXRlVXJsLmhvc3QgPT09IHJlcXVlc3QubmV4dFVybC5ob3N0KSB7XG4gICAgICAgICAgICAgICAgcmV3cml0ZVVybC5idWlsZElkID0gYnVpbGRJZCB8fCByZXdyaXRlVXJsLmJ1aWxkSWQ7XG4gICAgICAgICAgICAgICAgcmVzcG9uc2UuaGVhZGVycy5zZXQoXCJ4LW1pZGRsZXdhcmUtcmV3cml0ZVwiLCBTdHJpbmcocmV3cml0ZVVybCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8qKlxuICAgICAqIFdoZW4gdGhlIHJlcXVlc3QgaXMgYSBkYXRhIHJlcXVlc3Qgd2UgbXVzdCBzaG93IGlmIHRoZXJlIHdhcyBhIHJld3JpdGVcbiAgICAgKiB3aXRoIGFuIGludGVybmFsIGhlYWRlciBzbyB0aGUgY2xpZW50IGtub3dzIHdoaWNoIGNvbXBvbmVudCB0byBsb2FkXG4gICAgICogZnJvbSB0aGUgZGF0YSByZXF1ZXN0LlxuICAgICAqLyBjb25zdCByZWxhdGl2aXplZFJld3JpdGUgPSByZWxhdGl2aXplVVJMKFN0cmluZyhyZXdyaXRlVXJsKSwgU3RyaW5nKHJlcXVlc3RVcmwpKTtcbiAgICAgICAgaWYgKGlzRGF0YVJlcSAmJiAvLyBpZiB0aGUgcmV3cml0ZSBpcyBleHRlcm5hbCBhbmQgZXh0ZXJuYWwgcmV3cml0ZVxuICAgICAgICAvLyByZXNvbHZpbmcgY29uZmlnIGlzIGVuYWJsZWQgZG9uJ3QgYWRkIHRoaXMgaGVhZGVyXG4gICAgICAgIC8vIHNvIHRoZSB1cHN0cmVhbSBhcHAgY2FuIHNldCBpdCBpbnN0ZWFkXG4gICAgICAgICEocHJvY2Vzcy5lbnYuX19ORVhUX0VYVEVSTkFMX01JRERMRVdBUkVfUkVXUklURV9SRVNPTFZFICYmIHJlbGF0aXZpemVkUmV3cml0ZS5tYXRjaCgvaHR0cChzKT86XFwvXFwvLykpKSB7XG4gICAgICAgICAgICByZXNwb25zZS5oZWFkZXJzLnNldChcIngtbmV4dGpzLXJld3JpdGVcIiwgcmVsYXRpdml6ZWRSZXdyaXRlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICogRm9yIHJlZGlyZWN0cyB3ZSB3aWxsIG5vdCBpbmNsdWRlIHRoZSBsb2NhbGUgaW4gY2FzZSB3aGVuIGl0IGlzIHRoZVxuICAgKiBkZWZhdWx0IGFuZCB3ZSBtdXN0IGFsc28gbWFrZSBzdXJlIHRoZSBvdXRnb2luZyBVUkwgaXMgYSBkYXRhIG9uZSBpZlxuICAgKiB0aGUgaW5jb21pbmcgcmVxdWVzdCB3YXMgYSBkYXRhIHJlcXVlc3QuXG4gICAqLyBjb25zdCByZWRpcmVjdCA9IHJlc3BvbnNlID09IG51bGwgPyB2b2lkIDAgOiByZXNwb25zZS5oZWFkZXJzLmdldChcIkxvY2F0aW9uXCIpO1xuICAgIGlmIChyZXNwb25zZSAmJiByZWRpcmVjdCAmJiAhaXNFZGdlUmVuZGVyaW5nKSB7XG4gICAgICAgIGNvbnN0IHJlZGlyZWN0VVJMID0gbmV3IE5leHRVUkwocmVkaXJlY3QsIHtcbiAgICAgICAgICAgIGZvcmNlTG9jYWxlOiBmYWxzZSxcbiAgICAgICAgICAgIGhlYWRlcnM6IHBhcmFtcy5yZXF1ZXN0LmhlYWRlcnMsXG4gICAgICAgICAgICBuZXh0Q29uZmlnOiBwYXJhbXMucmVxdWVzdC5uZXh0Q29uZmlnXG4gICAgICAgIH0pO1xuICAgICAgICAvKipcbiAgICAgKiBSZXNwb25zZXMgY3JlYXRlZCBmcm9tIHJlZGlyZWN0cyBoYXZlIGltbXV0YWJsZSBoZWFkZXJzIHNvIHdlIGhhdmVcbiAgICAgKiB0byBjbG9uZSB0aGUgcmVzcG9uc2UgdG8gYmUgYWJsZSB0byBtb2RpZnkgaXQuXG4gICAgICovIHJlc3BvbnNlID0gbmV3IFJlc3BvbnNlKHJlc3BvbnNlLmJvZHksIHJlc3BvbnNlKTtcbiAgICAgICAgaWYgKCFwcm9jZXNzLmVudi5fX05FWFRfTk9fTUlERExFV0FSRV9VUkxfTk9STUFMSVpFKSB7XG4gICAgICAgICAgICBpZiAocmVkaXJlY3RVUkwuaG9zdCA9PT0gcmVxdWVzdC5uZXh0VXJsLmhvc3QpIHtcbiAgICAgICAgICAgICAgICByZWRpcmVjdFVSTC5idWlsZElkID0gYnVpbGRJZCB8fCByZWRpcmVjdFVSTC5idWlsZElkO1xuICAgICAgICAgICAgICAgIHJlc3BvbnNlLmhlYWRlcnMuc2V0KFwiTG9jYXRpb25cIiwgU3RyaW5nKHJlZGlyZWN0VVJMKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gICAgICogV2hlbiB0aGUgcmVxdWVzdCBpcyBhIGRhdGEgcmVxdWVzdCB3ZSBjYW4ndCB1c2UgdGhlIGxvY2F0aW9uIGhlYWRlciBhc1xuICAgICAqIGl0IG1heSBlbmQgdXAgd2l0aCBDT1JTIGVycm9yLiBJbnN0ZWFkIHdlIG1hcCB0byBhbiBpbnRlcm5hbCBoZWFkZXIgc29cbiAgICAgKiB0aGUgY2xpZW50IGtub3dzIHRoZSBkZXN0aW5hdGlvbi5cbiAgICAgKi8gaWYgKGlzRGF0YVJlcSkge1xuICAgICAgICAgICAgcmVzcG9uc2UuaGVhZGVycy5kZWxldGUoXCJMb2NhdGlvblwiKTtcbiAgICAgICAgICAgIHJlc3BvbnNlLmhlYWRlcnMuc2V0KFwieC1uZXh0anMtcmVkaXJlY3RcIiwgcmVsYXRpdml6ZVVSTChTdHJpbmcocmVkaXJlY3RVUkwpLCBTdHJpbmcocmVxdWVzdFVybCkpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjb25zdCBmaW5hbFJlc3BvbnNlID0gcmVzcG9uc2UgPyByZXNwb25zZSA6IE5leHRSZXNwb25zZS5uZXh0KCk7XG4gICAgLy8gRmxpZ2h0IGhlYWRlcnMgYXJlIG5vdCBvdmVycmlkYWJsZSAvIHJlbW92YWJsZSBzbyB0aGV5IGFyZSBhcHBsaWVkIGF0IHRoZSBlbmQuXG4gICAgY29uc3QgbWlkZGxld2FyZU92ZXJyaWRlSGVhZGVycyA9IGZpbmFsUmVzcG9uc2UuaGVhZGVycy5nZXQoXCJ4LW1pZGRsZXdhcmUtb3ZlcnJpZGUtaGVhZGVyc1wiKTtcbiAgICBjb25zdCBvdmVyd3JpdHRlbkhlYWRlcnMgPSBbXTtcbiAgICBpZiAobWlkZGxld2FyZU92ZXJyaWRlSGVhZGVycykge1xuICAgICAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBmbGlnaHRIZWFkZXJzKXtcbiAgICAgICAgICAgIGZpbmFsUmVzcG9uc2UuaGVhZGVycy5zZXQoYHgtbWlkZGxld2FyZS1yZXF1ZXN0LSR7a2V5fWAsIHZhbHVlKTtcbiAgICAgICAgICAgIG92ZXJ3cml0dGVuSGVhZGVycy5wdXNoKGtleSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG92ZXJ3cml0dGVuSGVhZGVycy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBmaW5hbFJlc3BvbnNlLmhlYWRlcnMuc2V0KFwieC1taWRkbGV3YXJlLW92ZXJyaWRlLWhlYWRlcnNcIiwgbWlkZGxld2FyZU92ZXJyaWRlSGVhZGVycyArIFwiLFwiICsgb3ZlcndyaXR0ZW5IZWFkZXJzLmpvaW4oXCIsXCIpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICByZXNwb25zZTogZmluYWxSZXNwb25zZSxcbiAgICAgICAgd2FpdFVudGlsOiBQcm9taXNlLmFsbChldmVudFt3YWl0VW50aWxTeW1ib2xdKSxcbiAgICAgICAgZmV0Y2hNZXRyaWNzOiByZXF1ZXN0LmZldGNoTWV0cmljc1xuICAgIH07XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFkYXB0ZXIuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(middleware)/./node_modules/next/dist/esm/server/web/adapter.js\n");

/***/ }),

/***/ "(middleware)/./node_modules/next/dist/esm/server/web/spec-extension/adapters/request-cookies.js":
/*!******************************************************************************************!*\
  !*** ./node_modules/next/dist/esm/server/web/spec-extension/adapters/request-cookies.js ***!
  \******************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   MutableRequestCookiesAdapter: () => (/* binding */ MutableRequestCookiesAdapter),\n/* harmony export */   ReadonlyRequestCookiesError: () => (/* binding */ ReadonlyRequestCookiesError),\n/* harmony export */   RequestCookiesAdapter: () => (/* binding */ RequestCookiesAdapter),\n/* harmony export */   appendMutableCookies: () => (/* binding */ appendMutableCookies),\n/* harmony export */   getModifiedCookieValues: () => (/* binding */ getModifiedCookieValues)\n/* harmony export */ });\n/* harmony import */ var _cookies__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../cookies */ \"(middleware)/./node_modules/next/dist/esm/server/web/spec-extension/cookies.js\");\n/* harmony import */ var _reflect__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./reflect */ \"(middleware)/./node_modules/next/dist/esm/server/web/spec-extension/adapters/reflect.js\");\n/* harmony import */ var _client_components_static_generation_async_storage_external__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../client/components/static-generation-async-storage.external */ \"(shared)/./node_modules/next/dist/esm/client/components/static-generation-async-storage.external.js\");\n\n\n\n/**\n * @internal\n */ class ReadonlyRequestCookiesError extends Error {\n    constructor(){\n        super(\"Cookies can only be modified in a Server Action or Route Handler. Read more: https://nextjs.org/docs/app/api-reference/functions/cookies#cookiessetname-value-options\");\n    }\n    static callable() {\n        throw new ReadonlyRequestCookiesError();\n    }\n}\nclass RequestCookiesAdapter {\n    static seal(cookies) {\n        return new Proxy(cookies, {\n            get (target, prop, receiver) {\n                switch(prop){\n                    case \"clear\":\n                    case \"delete\":\n                    case \"set\":\n                        return ReadonlyRequestCookiesError.callable;\n                    default:\n                        return _reflect__WEBPACK_IMPORTED_MODULE_1__.ReflectAdapter.get(target, prop, receiver);\n                }\n            }\n        });\n    }\n}\nconst SYMBOL_MODIFY_COOKIE_VALUES = Symbol.for(\"next.mutated.cookies\");\nfunction getModifiedCookieValues(cookies) {\n    const modified = cookies[SYMBOL_MODIFY_COOKIE_VALUES];\n    if (!modified || !Array.isArray(modified) || modified.length === 0) {\n        return [];\n    }\n    return modified;\n}\nfunction appendMutableCookies(headers, mutableCookies) {\n    const modifiedCookieValues = getModifiedCookieValues(mutableCookies);\n    if (modifiedCookieValues.length === 0) {\n        return false;\n    }\n    // Return a new response that extends the response with\n    // the modified cookies as fallbacks. `res` cookies\n    // will still take precedence.\n    const resCookies = new _cookies__WEBPACK_IMPORTED_MODULE_0__.ResponseCookies(headers);\n    const returnedCookies = resCookies.getAll();\n    // Set the modified cookies as fallbacks.\n    for (const cookie of modifiedCookieValues){\n        resCookies.set(cookie);\n    }\n    // Set the original cookies as the final values.\n    for (const cookie of returnedCookies){\n        resCookies.set(cookie);\n    }\n    return true;\n}\nclass MutableRequestCookiesAdapter {\n    static wrap(cookies, onUpdateCookies) {\n        const responseCookies = new _cookies__WEBPACK_IMPORTED_MODULE_0__.ResponseCookies(new Headers());\n        for (const cookie of cookies.getAll()){\n            responseCookies.set(cookie);\n        }\n        let modifiedValues = [];\n        const modifiedCookies = new Set();\n        const updateResponseCookies = ()=>{\n            // TODO-APP: change method of getting staticGenerationAsyncStore\n            const staticGenerationAsyncStore = _client_components_static_generation_async_storage_external__WEBPACK_IMPORTED_MODULE_2__.staticGenerationAsyncStorage.getStore();\n            if (staticGenerationAsyncStore) {\n                staticGenerationAsyncStore.pathWasRevalidated = true;\n            }\n            const allCookies = responseCookies.getAll();\n            modifiedValues = allCookies.filter((c)=>modifiedCookies.has(c.name));\n            if (onUpdateCookies) {\n                const serializedCookies = [];\n                for (const cookie of modifiedValues){\n                    const tempCookies = new _cookies__WEBPACK_IMPORTED_MODULE_0__.ResponseCookies(new Headers());\n                    tempCookies.set(cookie);\n                    serializedCookies.push(tempCookies.toString());\n                }\n                onUpdateCookies(serializedCookies);\n            }\n        };\n        return new Proxy(responseCookies, {\n            get (target, prop, receiver) {\n                switch(prop){\n                    // A special symbol to get the modified cookie values\n                    case SYMBOL_MODIFY_COOKIE_VALUES:\n                        return modifiedValues;\n                    // TODO: Throw error if trying to set a cookie after the response\n                    // headers have been set.\n                    case \"delete\":\n                        return function(...args) {\n                            modifiedCookies.add(typeof args[0] === \"string\" ? args[0] : args[0].name);\n                            try {\n                                target.delete(...args);\n                            } finally{\n                                updateResponseCookies();\n                            }\n                        };\n                    case \"set\":\n                        return function(...args) {\n                            modifiedCookies.add(typeof args[0] === \"string\" ? args[0] : args[0].name);\n                            try {\n                                return target.set(...args);\n                            } finally{\n                                updateResponseCookies();\n                            }\n                        };\n                    default:\n                        return _reflect__WEBPACK_IMPORTED_MODULE_1__.ReflectAdapter.get(target, prop, receiver);\n                }\n            }\n        });\n    }\n}\n\n//# sourceMappingURL=request-cookies.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKG1pZGRsZXdhcmUpLy4vbm9kZV9tb2R1bGVzL25leHQvZGlzdC9lc20vc2VydmVyL3dlYi9zcGVjLWV4dGVuc2lvbi9hZGFwdGVycy9yZXF1ZXN0LWNvb2tpZXMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBNkM7QUFDRjtBQUMyRTtBQUN0SDtBQUNBO0FBQ0EsSUFBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0Isb0RBQWM7QUFDN0M7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIscURBQWU7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQSxvQ0FBb0MscURBQWU7QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQ0FBK0MscUhBQTRCO0FBQzNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0Q0FBNEMscURBQWU7QUFDM0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4QkFBOEI7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhCQUE4QjtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQixvREFBYztBQUM3QztBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7O0FBRUEiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vbm9kZV9tb2R1bGVzL25leHQvZGlzdC9lc20vc2VydmVyL3dlYi9zcGVjLWV4dGVuc2lvbi9hZGFwdGVycy9yZXF1ZXN0LWNvb2tpZXMuanM/NzE2MCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBSZXNwb25zZUNvb2tpZXMgfSBmcm9tIFwiLi4vY29va2llc1wiO1xuaW1wb3J0IHsgUmVmbGVjdEFkYXB0ZXIgfSBmcm9tIFwiLi9yZWZsZWN0XCI7XG5pbXBvcnQgeyBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlIH0gZnJvbSBcIi4uLy4uLy4uLy4uL2NsaWVudC9jb21wb25lbnRzL3N0YXRpYy1nZW5lcmF0aW9uLWFzeW5jLXN0b3JhZ2UuZXh0ZXJuYWxcIjtcbi8qKlxuICogQGludGVybmFsXG4gKi8gZXhwb3J0IGNsYXNzIFJlYWRvbmx5UmVxdWVzdENvb2tpZXNFcnJvciBleHRlbmRzIEVycm9yIHtcbiAgICBjb25zdHJ1Y3Rvcigpe1xuICAgICAgICBzdXBlcihcIkNvb2tpZXMgY2FuIG9ubHkgYmUgbW9kaWZpZWQgaW4gYSBTZXJ2ZXIgQWN0aW9uIG9yIFJvdXRlIEhhbmRsZXIuIFJlYWQgbW9yZTogaHR0cHM6Ly9uZXh0anMub3JnL2RvY3MvYXBwL2FwaS1yZWZlcmVuY2UvZnVuY3Rpb25zL2Nvb2tpZXMjY29va2llc3NldG5hbWUtdmFsdWUtb3B0aW9uc1wiKTtcbiAgICB9XG4gICAgc3RhdGljIGNhbGxhYmxlKCkge1xuICAgICAgICB0aHJvdyBuZXcgUmVhZG9ubHlSZXF1ZXN0Q29va2llc0Vycm9yKCk7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIFJlcXVlc3RDb29raWVzQWRhcHRlciB7XG4gICAgc3RhdGljIHNlYWwoY29va2llcykge1xuICAgICAgICByZXR1cm4gbmV3IFByb3h5KGNvb2tpZXMsIHtcbiAgICAgICAgICAgIGdldCAodGFyZ2V0LCBwcm9wLCByZWNlaXZlcikge1xuICAgICAgICAgICAgICAgIHN3aXRjaChwcm9wKXtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcImNsZWFyXCI6XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJkZWxldGVcIjpcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcInNldFwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFJlYWRvbmx5UmVxdWVzdENvb2tpZXNFcnJvci5jYWxsYWJsZTtcbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBSZWZsZWN0QWRhcHRlci5nZXQodGFyZ2V0LCBwcm9wLCByZWNlaXZlcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG59XG5jb25zdCBTWU1CT0xfTU9ESUZZX0NPT0tJRV9WQUxVRVMgPSBTeW1ib2wuZm9yKFwibmV4dC5tdXRhdGVkLmNvb2tpZXNcIik7XG5leHBvcnQgZnVuY3Rpb24gZ2V0TW9kaWZpZWRDb29raWVWYWx1ZXMoY29va2llcykge1xuICAgIGNvbnN0IG1vZGlmaWVkID0gY29va2llc1tTWU1CT0xfTU9ESUZZX0NPT0tJRV9WQUxVRVNdO1xuICAgIGlmICghbW9kaWZpZWQgfHwgIUFycmF5LmlzQXJyYXkobW9kaWZpZWQpIHx8IG1vZGlmaWVkLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICByZXR1cm4gW107XG4gICAgfVxuICAgIHJldHVybiBtb2RpZmllZDtcbn1cbmV4cG9ydCBmdW5jdGlvbiBhcHBlbmRNdXRhYmxlQ29va2llcyhoZWFkZXJzLCBtdXRhYmxlQ29va2llcykge1xuICAgIGNvbnN0IG1vZGlmaWVkQ29va2llVmFsdWVzID0gZ2V0TW9kaWZpZWRDb29raWVWYWx1ZXMobXV0YWJsZUNvb2tpZXMpO1xuICAgIGlmIChtb2RpZmllZENvb2tpZVZhbHVlcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICAvLyBSZXR1cm4gYSBuZXcgcmVzcG9uc2UgdGhhdCBleHRlbmRzIHRoZSByZXNwb25zZSB3aXRoXG4gICAgLy8gdGhlIG1vZGlmaWVkIGNvb2tpZXMgYXMgZmFsbGJhY2tzLiBgcmVzYCBjb29raWVzXG4gICAgLy8gd2lsbCBzdGlsbCB0YWtlIHByZWNlZGVuY2UuXG4gICAgY29uc3QgcmVzQ29va2llcyA9IG5ldyBSZXNwb25zZUNvb2tpZXMoaGVhZGVycyk7XG4gICAgY29uc3QgcmV0dXJuZWRDb29raWVzID0gcmVzQ29va2llcy5nZXRBbGwoKTtcbiAgICAvLyBTZXQgdGhlIG1vZGlmaWVkIGNvb2tpZXMgYXMgZmFsbGJhY2tzLlxuICAgIGZvciAoY29uc3QgY29va2llIG9mIG1vZGlmaWVkQ29va2llVmFsdWVzKXtcbiAgICAgICAgcmVzQ29va2llcy5zZXQoY29va2llKTtcbiAgICB9XG4gICAgLy8gU2V0IHRoZSBvcmlnaW5hbCBjb29raWVzIGFzIHRoZSBmaW5hbCB2YWx1ZXMuXG4gICAgZm9yIChjb25zdCBjb29raWUgb2YgcmV0dXJuZWRDb29raWVzKXtcbiAgICAgICAgcmVzQ29va2llcy5zZXQoY29va2llKTtcbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG59XG5leHBvcnQgY2xhc3MgTXV0YWJsZVJlcXVlc3RDb29raWVzQWRhcHRlciB7XG4gICAgc3RhdGljIHdyYXAoY29va2llcywgb25VcGRhdGVDb29raWVzKSB7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlQ29va2llcyA9IG5ldyBSZXNwb25zZUNvb2tpZXMobmV3IEhlYWRlcnMoKSk7XG4gICAgICAgIGZvciAoY29uc3QgY29va2llIG9mIGNvb2tpZXMuZ2V0QWxsKCkpe1xuICAgICAgICAgICAgcmVzcG9uc2VDb29raWVzLnNldChjb29raWUpO1xuICAgICAgICB9XG4gICAgICAgIGxldCBtb2RpZmllZFZhbHVlcyA9IFtdO1xuICAgICAgICBjb25zdCBtb2RpZmllZENvb2tpZXMgPSBuZXcgU2V0KCk7XG4gICAgICAgIGNvbnN0IHVwZGF0ZVJlc3BvbnNlQ29va2llcyA9ICgpPT57XG4gICAgICAgICAgICAvLyBUT0RPLUFQUDogY2hhbmdlIG1ldGhvZCBvZiBnZXR0aW5nIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JlXG4gICAgICAgICAgICBjb25zdCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yZSA9IHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UuZ2V0U3RvcmUoKTtcbiAgICAgICAgICAgIGlmIChzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yZSkge1xuICAgICAgICAgICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JlLnBhdGhXYXNSZXZhbGlkYXRlZCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBhbGxDb29raWVzID0gcmVzcG9uc2VDb29raWVzLmdldEFsbCgpO1xuICAgICAgICAgICAgbW9kaWZpZWRWYWx1ZXMgPSBhbGxDb29raWVzLmZpbHRlcigoYyk9Pm1vZGlmaWVkQ29va2llcy5oYXMoYy5uYW1lKSk7XG4gICAgICAgICAgICBpZiAob25VcGRhdGVDb29raWVzKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2VyaWFsaXplZENvb2tpZXMgPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGNvb2tpZSBvZiBtb2RpZmllZFZhbHVlcyl7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHRlbXBDb29raWVzID0gbmV3IFJlc3BvbnNlQ29va2llcyhuZXcgSGVhZGVycygpKTtcbiAgICAgICAgICAgICAgICAgICAgdGVtcENvb2tpZXMuc2V0KGNvb2tpZSk7XG4gICAgICAgICAgICAgICAgICAgIHNlcmlhbGl6ZWRDb29raWVzLnB1c2godGVtcENvb2tpZXMudG9TdHJpbmcoKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG9uVXBkYXRlQ29va2llcyhzZXJpYWxpemVkQ29va2llcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBuZXcgUHJveHkocmVzcG9uc2VDb29raWVzLCB7XG4gICAgICAgICAgICBnZXQgKHRhcmdldCwgcHJvcCwgcmVjZWl2ZXIpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2gocHJvcCl7XG4gICAgICAgICAgICAgICAgICAgIC8vIEEgc3BlY2lhbCBzeW1ib2wgdG8gZ2V0IHRoZSBtb2RpZmllZCBjb29raWUgdmFsdWVzXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgU1lNQk9MX01PRElGWV9DT09LSUVfVkFMVUVTOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1vZGlmaWVkVmFsdWVzO1xuICAgICAgICAgICAgICAgICAgICAvLyBUT0RPOiBUaHJvdyBlcnJvciBpZiB0cnlpbmcgdG8gc2V0IGEgY29va2llIGFmdGVyIHRoZSByZXNwb25zZVxuICAgICAgICAgICAgICAgICAgICAvLyBoZWFkZXJzIGhhdmUgYmVlbiBzZXQuXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJkZWxldGVcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiguLi5hcmdzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kaWZpZWRDb29raWVzLmFkZCh0eXBlb2YgYXJnc1swXSA9PT0gXCJzdHJpbmdcIiA/IGFyZ3NbMF0gOiBhcmdzWzBdLm5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldC5kZWxldGUoLi4uYXJncyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBmaW5hbGx5e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVSZXNwb25zZUNvb2tpZXMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwic2V0XCI6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oLi4uYXJncykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGlmaWVkQ29va2llcy5hZGQodHlwZW9mIGFyZ3NbMF0gPT09IFwic3RyaW5nXCIgPyBhcmdzWzBdIDogYXJnc1swXS5uYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGFyZ2V0LnNldCguLi5hcmdzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGZpbmFsbHl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZVJlc3BvbnNlQ29va2llcygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gUmVmbGVjdEFkYXB0ZXIuZ2V0KHRhcmdldCwgcHJvcCwgcmVjZWl2ZXIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1yZXF1ZXN0LWNvb2tpZXMuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(middleware)/./node_modules/next/dist/esm/server/web/spec-extension/adapters/request-cookies.js\n");

/***/ }),

/***/ "(middleware)/./src/middleware.ts":
/*!***************************!*\
  !*** ./src/middleware.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var next_auth_middleware__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next-auth/middleware */ \"(middleware)/./node_modules/next-auth/middleware.js\");\n/* harmony import */ var next_auth_middleware__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_auth_middleware__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/server */ \"(middleware)/./node_modules/next/dist/esm/api/server.js\");\n/* harmony import */ var _lib_domain__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/domain */ \"(middleware)/./src/lib/domain.ts\");\n\n\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_auth_middleware__WEBPACK_IMPORTED_MODULE_0__.withAuth)(async function middleware(req) {\n    const { pathname } = req.nextUrl;\n    const token = req.nextauth.token;\n    // Get hostname from X-Forwarded-Host (Nginx proxy) or fall back to req.nextUrl.hostname\n    const forwardedHost = req.headers.get(\"x-forwarded-host\") || req.headers.get(\"host\");\n    const hostname = forwardedHost;\n    console.log(`[Middleware] Request: ${hostname}${pathname}`, {\n        \"x-forwarded-host\": req.headers.get(\"x-forwarded-host\"),\n        host: req.headers.get(\"host\"),\n        \"nextUrl.hostname\": req.nextUrl.hostname\n    });\n    // Skip processing for localhost and development\n    if (!req.headers.get(\"x-middleware-request\") && (hostname === \"localhost\" || hostname.includes(\"localhost\"))) {\n        console.log(\"[Middleware] Skipping external localhost\");\n        return next_server__WEBPACK_IMPORTED_MODULE_1__.NextResponse.next();\n    }\n    // Simple domain extraction\n    const cleanDomain = hostname.toLowerCase().replace(/^www\\./, \"\");\n    // Check if this is a custom domain (not our main application domains)\n    const mainAppDomain = process.env.NEXTAUTH_URL?.replace(/^https?:\\/\\//, \"\").split(\"/\")[0] || \"eaip.flyclim.com\";\n    const isMainDomain = hostname === mainAppDomain || hostname === \"eaip.flyclim.com\" || // Always treat eaip.flyclim.com as main domain\n    hostname === \"localhost\" || hostname === \"0.0.0.0\" || hostname.includes(\"localhost\") || hostname.includes(\"vercel.app\") || hostname.includes(\"netlify.app\");\n    console.log(`[Middleware] Domain check:`, {\n        hostname,\n        cleanDomain,\n        mainAppDomain,\n        isMainDomain\n    });\n    // Handle tenant-specific domain routing\n    if (!isMainDomain && cleanDomain !== \"localhost\") {\n        try {\n            // For custom domains, use an API call to lookup organization\n            // Use localhost for internal API calls to avoid SSL issues\n            const internalOrigin = \"http://localhost:3000\";\n            const domainLookupUrl = new URL(\"/api/organizations/by-domain\", internalOrigin);\n            domainLookupUrl.searchParams.set(\"domain\", cleanDomain);\n            console.log(\"[Middleware] Fetching org data from:\", domainLookupUrl.toString());\n            const domainResponse = await fetch(domainLookupUrl.toString(), {\n                headers: {\n                    \"x-middleware-request\": \"true\"\n                }\n            });\n            if (domainResponse.ok) {\n                const domainData = await domainResponse.json();\n                if (domainData.success && domainData.organization) {\n                    // Set organization context headers\n                    const requestHeaders = new Headers(req.headers);\n                    requestHeaders.set(\"x-tenant-domain\", cleanDomain);\n                    requestHeaders.set(\"x-tenant-org-id\", domainData.organization._id);\n                    requestHeaders.set(\"x-tenant-org-name\", domainData.organization.name);\n                    // For authenticated users, validate they belong to this organization\n                    if (token) {\n                        const userOrgId = token.organizationId;\n                        const domainOrgId = domainData.organization._id;\n                        // Block cross-tenant access\n                        if (!_lib_domain__WEBPACK_IMPORTED_MODULE_2__.DomainService.validateUserAccess(userOrgId, domainOrgId) && !pathname.startsWith(\"/auth/signin\")) {\n                            console.log(`Access denied: User org ${userOrgId} accessing domain org ${domainOrgId}`);\n                            // Redirect to domain-specific login\n                            const loginUrl = new URL(\"/auth/signin\", req.url);\n                            loginUrl.searchParams.set(\"error\", \"unauthorized\");\n                            loginUrl.searchParams.set(\"callbackUrl\", pathname);\n                            return next_server__WEBPACK_IMPORTED_MODULE_1__.NextResponse.redirect(loginUrl);\n                        }\n                    }\n                    // Custom domains ONLY serve public pages\n                    // Redirect all custom domain traffic to public eAIP pages\n                    const url = req.nextUrl.clone();\n                    const orgDomain = domainData.organization.domain;\n                    // Map root to public organization page\n                    if (pathname === \"/\") {\n                        url.pathname = `/public/${orgDomain}`;\n                        console.log(`[Custom Domain] Root rewrite: ${hostname}/  ${url.pathname}`);\n                        return next_server__WEBPACK_IMPORTED_MODULE_1__.NextResponse.rewrite(url, {\n                            request: {\n                                headers: requestHeaders\n                            }\n                        });\n                    }\n                    // Map document IDs directly to public document pages\n                    // Pattern: /{documentId}  /public/{domain}/{documentId}\n                    const documentIdPattern = /^\\/([a-f0-9]{24})$/i; // MongoDB ObjectId pattern\n                    if (documentIdPattern.test(pathname)) {\n                        url.pathname = `/public/${orgDomain}${pathname}`;\n                        console.log(`[Custom Domain] Document rewrite: ${hostname}${pathname}  ${url.pathname}`);\n                        return next_server__WEBPACK_IMPORTED_MODULE_1__.NextResponse.rewrite(url, {\n                            request: {\n                                headers: requestHeaders\n                            }\n                        });\n                    }\n                    // Handle /public routes on custom domains\n                    if (pathname.startsWith(\"/public\")) {\n                        // If accessing /public/{orgDomain} on custom domain, redirect to root\n                        if (pathname === `/public/${orgDomain}`) {\n                            console.log(`[Custom Domain] Redirect /public/${orgDomain}  /`);\n                            return next_server__WEBPACK_IMPORTED_MODULE_1__.NextResponse.redirect(new URL(\"/\", req.url));\n                        }\n                        // If accessing /public/{orgDomain}/{documentId}, redirect to /{documentId}\n                        const publicDocPattern = new RegExp(`^/public/${orgDomain.replace(\".\", \"\\\\.\")}/([a-f0-9]{24})$`, \"i\");\n                        const match = pathname.match(publicDocPattern);\n                        if (match) {\n                            const docId = match[1];\n                            console.log(`[Custom Domain] Redirect /public/${orgDomain}/${docId}  /${docId}`);\n                            return next_server__WEBPACK_IMPORTED_MODULE_1__.NextResponse.redirect(new URL(`/${docId}`, req.url));\n                        }\n                        console.log(`[Custom Domain] Public route passthrough: ${pathname}`);\n                        return next_server__WEBPACK_IMPORTED_MODULE_1__.NextResponse.rewrite(url, {\n                            request: {\n                                headers: requestHeaders\n                            }\n                        });\n                    }\n                    // Allow API calls for public data\n                    if (pathname.startsWith(\"/api/public\")) {\n                        console.log(`[Custom Domain] API passthrough: ${pathname}`);\n                        return next_server__WEBPACK_IMPORTED_MODULE_1__.NextResponse.next({\n                            request: {\n                                headers: requestHeaders\n                            }\n                        });\n                    }\n                    // Block all other routes on custom domains (admin, dashboard, auth, etc.)\n                    // Users must access the main app domain (eaip.flyclim.com) for these features\n                    console.log(`Custom domain ${cleanDomain} blocked access to: ${pathname}`);\n                    return new next_server__WEBPACK_IMPORTED_MODULE_1__.NextResponse(JSON.stringify({\n                        error: \"Access Denied\",\n                        message: `This custom domain only provides public eAIP access. For administration, please visit the main application at ${process.env.NEXTAUTH_URL || \"https://eaip.flyclim.com\"}`,\n                        code: \"CUSTOM_DOMAIN_PUBLIC_ONLY\"\n                    }), {\n                        status: 403,\n                        headers: {\n                            \"content-type\": \"application/json\"\n                        }\n                    });\n                }\n            }\n            // Domain not found in our system\n            return new next_server__WEBPACK_IMPORTED_MODULE_1__.NextResponse(JSON.stringify({\n                error: \"Domain not configured\",\n                message: `The domain ${cleanDomain} is not associated with any organization.`,\n                code: \"DOMAIN_NOT_FOUND\"\n            }), {\n                status: 404,\n                headers: {\n                    \"content-type\": \"application/json\"\n                }\n            });\n        } catch (error) {\n            console.error(\"Domain lookup error:\", error);\n            return new next_server__WEBPACK_IMPORTED_MODULE_1__.NextResponse(JSON.stringify({\n                error: \"Domain lookup failed\",\n                message: \"Unable to resolve domain configuration.\",\n                code: \"DOMAIN_LOOKUP_ERROR\"\n            }), {\n                status: 500,\n                headers: {\n                    \"content-type\": \"application/json\"\n                }\n            });\n        }\n    }\n    // Main domain handling - no special tenant validation needed\n    return next_server__WEBPACK_IMPORTED_MODULE_1__.NextResponse.next();\n}, {\n    callbacks: {\n        authorized: ({ token, req })=>{\n            const { pathname } = req.nextUrl;\n            // Define route categories\n            const publicRoutes = [\n                \"/public\",\n                \"/eaip\",\n                \"/api/public\",\n                \"/auth/signin\",\n                \"/auth/signup\",\n                \"/auth/error\",\n                \"/_next\",\n                \"/favicon.ico\"\n            ];\n            const protectedRoutes = [\n                \"/admin\",\n                \"/dashboard\",\n                \"/documents\",\n                \"/versions\",\n                \"/exports\",\n                \"/profile\",\n                \"/organization\",\n                \"/api/admin\",\n                \"/api/documents\",\n                \"/api/users\"\n            ];\n            // Allow public routes without authentication\n            if (publicRoutes.some((route)=>pathname.startsWith(route))) {\n                return true;\n            }\n            // Check if route requires authentication\n            const requiresAuth = protectedRoutes.some((route)=>pathname.startsWith(route));\n            if (requiresAuth) {\n                // Require valid token for protected routes\n                if (!token) {\n                    return false;\n                }\n                // Additional role-based checks\n                if (pathname.startsWith(\"/admin\") && token.role !== \"super_admin\") {\n                    return false;\n                }\n                return true;\n            }\n            // Default: allow access to unspecified routes\n            return true;\n        }\n    }\n}));\nconst config = {\n    matcher: [\n        /*\n     * Match all request paths except for the ones starting with:\n     * - api/auth (auth endpoints)\n     * - _next/static (static files)\n     * - _next/image (image optimization files)\n     * - favicon.ico (favicon file)\n     * - public folder\n     */ \"/((?!api/auth|_next/static|_next/image|favicon.ico|uploads|exports|auth).*)\"\n    ]\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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bGV3YXJlLnRzP2QxOTkiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgd2l0aEF1dGggfSBmcm9tIFwibmV4dC1hdXRoL21pZGRsZXdhcmVcIjtcbmltcG9ydCB7IE5leHRSZXNwb25zZSB9IGZyb20gXCJuZXh0L3NlcnZlclwiO1xuaW1wb3J0IHsgRG9tYWluU2VydmljZSB9IGZyb20gXCJAL2xpYi9kb21haW5cIjtcblxuZXhwb3J0IGRlZmF1bHQgd2l0aEF1dGgoXG4gIGFzeW5jIGZ1bmN0aW9uIG1pZGRsZXdhcmUocmVxKSB7XG4gICAgY29uc3QgeyBwYXRobmFtZSB9ID0gcmVxLm5leHRVcmw7XG4gICAgY29uc3QgdG9rZW4gPSByZXEubmV4dGF1dGgudG9rZW47XG5cbiAgICAvLyBHZXQgaG9zdG5hbWUgZnJvbSBYLUZvcndhcmRlZC1Ib3N0IChOZ2lueCBwcm94eSkgb3IgZmFsbCBiYWNrIHRvIHJlcS5uZXh0VXJsLmhvc3RuYW1lXG4gICAgY29uc3QgZm9yd2FyZGVkSG9zdCA9XG4gICAgICByZXEuaGVhZGVycy5nZXQoXCJ4LWZvcndhcmRlZC1ob3N0XCIpIHx8IHJlcS5oZWFkZXJzLmdldChcImhvc3RcIik7XG4gICAgY29uc3QgaG9zdG5hbWUgPSBmb3J3YXJkZWRIb3N0O1xuXG4gICAgY29uc29sZS5sb2coYFtNaWRkbGV3YXJlXSBSZXF1ZXN0OiAke2hvc3RuYW1lfSR7cGF0aG5hbWV9YCwge1xuICAgICAgXCJ4LWZvcndhcmRlZC1ob3N0XCI6IHJlcS5oZWFkZXJzLmdldChcIngtZm9yd2FyZGVkLWhvc3RcIiksXG4gICAgICBob3N0OiByZXEuaGVhZGVycy5nZXQoXCJob3N0XCIpLFxuICAgICAgXCJuZXh0VXJsLmhvc3RuYW1lXCI6IHJlcS5uZXh0VXJsLmhvc3RuYW1lLFxuICAgIH0pO1xuXG4gICAgLy8gU2tpcCBwcm9jZXNzaW5nIGZvciBsb2NhbGhvc3QgYW5kIGRldmVsb3BtZW50XG4gICAgaWYgKFxuICAgICAgIXJlcS5oZWFkZXJzLmdldChcIngtbWlkZGxld2FyZS1yZXF1ZXN0XCIpICYmXG4gICAgICAoaG9zdG5hbWUgPT09IFwibG9jYWxob3N0XCIgfHwgaG9zdG5hbWUuaW5jbHVkZXMoXCJsb2NhbGhvc3RcIikpXG4gICAgKSB7XG4gICAgICBjb25zb2xlLmxvZyhcIltNaWRkbGV3YXJlXSBTa2lwcGluZyBleHRlcm5hbCBsb2NhbGhvc3RcIik7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLm5leHQoKTtcbiAgICB9XG5cbiAgICAvLyBTaW1wbGUgZG9tYWluIGV4dHJhY3Rpb25cbiAgICBjb25zdCBjbGVhbkRvbWFpbiA9IGhvc3RuYW1lLnRvTG93ZXJDYXNlKCkucmVwbGFjZSgvXnd3d1xcLi8sIFwiXCIpO1xuXG4gICAgLy8gQ2hlY2sgaWYgdGhpcyBpcyBhIGN1c3RvbSBkb21haW4gKG5vdCBvdXIgbWFpbiBhcHBsaWNhdGlvbiBkb21haW5zKVxuICAgIGNvbnN0IG1haW5BcHBEb21haW4gPVxuICAgICAgcHJvY2Vzcy5lbnYuTkVYVEFVVEhfVVJMPy5yZXBsYWNlKC9eaHR0cHM/OlxcL1xcLy8sIFwiXCIpLnNwbGl0KFwiL1wiKVswXSB8fFxuICAgICAgXCJlYWlwLmZseWNsaW0uY29tXCI7XG4gICAgY29uc3QgaXNNYWluRG9tYWluID1cbiAgICAgIGhvc3RuYW1lID09PSBtYWluQXBwRG9tYWluIHx8XG4gICAgICBob3N0bmFtZSA9PT0gXCJlYWlwLmZseWNsaW0uY29tXCIgfHwgLy8gQWx3YXlzIHRyZWF0IGVhaXAuZmx5Y2xpbS5jb20gYXMgbWFpbiBkb21haW5cbiAgICAgIGhvc3RuYW1lID09PSBcImxvY2FsaG9zdFwiIHx8XG4gICAgICBob3N0bmFtZSA9PT0gXCIwLjAuMC4wXCIgfHxcbiAgICAgIGhvc3RuYW1lLmluY2x1ZGVzKFwibG9jYWxob3N0XCIpIHx8XG4gICAgICBob3N0bmFtZS5pbmNsdWRlcyhcInZlcmNlbC5hcHBcIikgfHxcbiAgICAgIGhvc3RuYW1lLmluY2x1ZGVzKFwibmV0bGlmeS5hcHBcIik7XG5cbiAgICBjb25zb2xlLmxvZyhgW01pZGRsZXdhcmVdIERvbWFpbiBjaGVjazpgLCB7XG4gICAgICBob3N0bmFtZSxcbiAgICAgIGNsZWFuRG9tYWluLFxuICAgICAgbWFpbkFwcERvbWFpbixcbiAgICAgIGlzTWFpbkRvbWFpbixcbiAgICB9KTtcblxuICAgIC8vIEhhbmRsZSB0ZW5hbnQtc3BlY2lmaWMgZG9tYWluIHJvdXRpbmdcbiAgICBpZiAoIWlzTWFpbkRvbWFpbiAmJiBjbGVhbkRvbWFpbiAhPT0gXCJsb2NhbGhvc3RcIikge1xuICAgICAgdHJ5IHtcbiAgICAgICAgLy8gRm9yIGN1c3RvbSBkb21haW5zLCB1c2UgYW4gQVBJIGNhbGwgdG8gbG9va3VwIG9yZ2FuaXphdGlvblxuICAgICAgICAvLyBVc2UgbG9jYWxob3N0IGZvciBpbnRlcm5hbCBBUEkgY2FsbHMgdG8gYXZvaWQgU1NMIGlzc3Vlc1xuICAgICAgICBjb25zdCBpbnRlcm5hbE9yaWdpbiA9IFwiaHR0cDovL2xvY2FsaG9zdDozMDAwXCI7XG4gICAgICAgIGNvbnN0IGRvbWFpbkxvb2t1cFVybCA9IG5ldyBVUkwoXG4gICAgICAgICAgXCIvYXBpL29yZ2FuaXphdGlvbnMvYnktZG9tYWluXCIsXG4gICAgICAgICAgaW50ZXJuYWxPcmlnaW5cbiAgICAgICAgKTtcbiAgICAgICAgZG9tYWluTG9va3VwVXJsLnNlYXJjaFBhcmFtcy5zZXQoXCJkb21haW5cIiwgY2xlYW5Eb21haW4pO1xuXG4gICAgICAgIGNvbnNvbGUubG9nKFxuICAgICAgICAgIFwiW01pZGRsZXdhcmVdIEZldGNoaW5nIG9yZyBkYXRhIGZyb206XCIsXG4gICAgICAgICAgZG9tYWluTG9va3VwVXJsLnRvU3RyaW5nKClcbiAgICAgICAgKTtcblxuICAgICAgICBjb25zdCBkb21haW5SZXNwb25zZSA9IGF3YWl0IGZldGNoKGRvbWFpbkxvb2t1cFVybC50b1N0cmluZygpLCB7XG4gICAgICAgICAgaGVhZGVyczogeyBcIngtbWlkZGxld2FyZS1yZXF1ZXN0XCI6IFwidHJ1ZVwiIH0sXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmIChkb21haW5SZXNwb25zZS5vaykge1xuICAgICAgICAgIGNvbnN0IGRvbWFpbkRhdGEgPSBhd2FpdCBkb21haW5SZXNwb25zZS5qc29uKCk7XG5cbiAgICAgICAgICBpZiAoZG9tYWluRGF0YS5zdWNjZXNzICYmIGRvbWFpbkRhdGEub3JnYW5pemF0aW9uKSB7XG4gICAgICAgICAgICAvLyBTZXQgb3JnYW5pemF0aW9uIGNvbnRleHQgaGVhZGVyc1xuICAgICAgICAgICAgY29uc3QgcmVxdWVzdEhlYWRlcnMgPSBuZXcgSGVhZGVycyhyZXEuaGVhZGVycyk7XG4gICAgICAgICAgICByZXF1ZXN0SGVhZGVycy5zZXQoXCJ4LXRlbmFudC1kb21haW5cIiwgY2xlYW5Eb21haW4pO1xuICAgICAgICAgICAgcmVxdWVzdEhlYWRlcnMuc2V0KFwieC10ZW5hbnQtb3JnLWlkXCIsIGRvbWFpbkRhdGEub3JnYW5pemF0aW9uLl9pZCk7XG4gICAgICAgICAgICByZXF1ZXN0SGVhZGVycy5zZXQoXG4gICAgICAgICAgICAgIFwieC10ZW5hbnQtb3JnLW5hbWVcIixcbiAgICAgICAgICAgICAgZG9tYWluRGF0YS5vcmdhbml6YXRpb24ubmFtZVxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgLy8gRm9yIGF1dGhlbnRpY2F0ZWQgdXNlcnMsIHZhbGlkYXRlIHRoZXkgYmVsb25nIHRvIHRoaXMgb3JnYW5pemF0aW9uXG4gICAgICAgICAgICBpZiAodG9rZW4pIHtcbiAgICAgICAgICAgICAgY29uc3QgdXNlck9yZ0lkID0gdG9rZW4ub3JnYW5pemF0aW9uSWQgYXMgc3RyaW5nO1xuICAgICAgICAgICAgICBjb25zdCBkb21haW5PcmdJZCA9IGRvbWFpbkRhdGEub3JnYW5pemF0aW9uLl9pZDtcblxuICAgICAgICAgICAgICAvLyBCbG9jayBjcm9zcy10ZW5hbnQgYWNjZXNzXG4gICAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICAhRG9tYWluU2VydmljZS52YWxpZGF0ZVVzZXJBY2Nlc3ModXNlck9yZ0lkLCBkb21haW5PcmdJZCkgJiZcbiAgICAgICAgICAgICAgICAhcGF0aG5hbWUuc3RhcnRzV2l0aChcIi9hdXRoL3NpZ25pblwiKVxuICAgICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcbiAgICAgICAgICAgICAgICAgIGBBY2Nlc3MgZGVuaWVkOiBVc2VyIG9yZyAke3VzZXJPcmdJZH0gYWNjZXNzaW5nIGRvbWFpbiBvcmcgJHtkb21haW5PcmdJZH1gXG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgIC8vIFJlZGlyZWN0IHRvIGRvbWFpbi1zcGVjaWZpYyBsb2dpblxuICAgICAgICAgICAgICAgIGNvbnN0IGxvZ2luVXJsID0gbmV3IFVSTChcIi9hdXRoL3NpZ25pblwiLCByZXEudXJsKTtcbiAgICAgICAgICAgICAgICBsb2dpblVybC5zZWFyY2hQYXJhbXMuc2V0KFwiZXJyb3JcIiwgXCJ1bmF1dGhvcml6ZWRcIik7XG4gICAgICAgICAgICAgICAgbG9naW5Vcmwuc2VhcmNoUGFyYW1zLnNldChcImNhbGxiYWNrVXJsXCIsIHBhdGhuYW1lKTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UucmVkaXJlY3QobG9naW5VcmwpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEN1c3RvbSBkb21haW5zIE9OTFkgc2VydmUgcHVibGljIHBhZ2VzXG4gICAgICAgICAgICAvLyBSZWRpcmVjdCBhbGwgY3VzdG9tIGRvbWFpbiB0cmFmZmljIHRvIHB1YmxpYyBlQUlQIHBhZ2VzXG4gICAgICAgICAgICBjb25zdCB1cmwgPSByZXEubmV4dFVybC5jbG9uZSgpO1xuICAgICAgICAgICAgY29uc3Qgb3JnRG9tYWluID0gZG9tYWluRGF0YS5vcmdhbml6YXRpb24uZG9tYWluO1xuXG4gICAgICAgICAgICAvLyBNYXAgcm9vdCB0byBwdWJsaWMgb3JnYW5pemF0aW9uIHBhZ2VcbiAgICAgICAgICAgIGlmIChwYXRobmFtZSA9PT0gXCIvXCIpIHtcbiAgICAgICAgICAgICAgdXJsLnBhdGhuYW1lID0gYC9wdWJsaWMvJHtvcmdEb21haW59YDtcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coXG4gICAgICAgICAgICAgICAgYFtDdXN0b20gRG9tYWluXSBSb290IHJld3JpdGU6ICR7aG9zdG5hbWV9LyDihpIgJHt1cmwucGF0aG5hbWV9YFxuICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLnJld3JpdGUodXJsLCB7XG4gICAgICAgICAgICAgICAgcmVxdWVzdDogeyBoZWFkZXJzOiByZXF1ZXN0SGVhZGVycyB9LFxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gTWFwIGRvY3VtZW50IElEcyBkaXJlY3RseSB0byBwdWJsaWMgZG9jdW1lbnQgcGFnZXNcbiAgICAgICAgICAgIC8vIFBhdHRlcm46IC97ZG9jdW1lbnRJZH0g4oaSIC9wdWJsaWMve2RvbWFpbn0ve2RvY3VtZW50SWR9XG4gICAgICAgICAgICBjb25zdCBkb2N1bWVudElkUGF0dGVybiA9IC9eXFwvKFthLWYwLTldezI0fSkkL2k7IC8vIE1vbmdvREIgT2JqZWN0SWQgcGF0dGVyblxuICAgICAgICAgICAgaWYgKGRvY3VtZW50SWRQYXR0ZXJuLnRlc3QocGF0aG5hbWUpKSB7XG4gICAgICAgICAgICAgIHVybC5wYXRobmFtZSA9IGAvcHVibGljLyR7b3JnRG9tYWlufSR7cGF0aG5hbWV9YDtcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coXG4gICAgICAgICAgICAgICAgYFtDdXN0b20gRG9tYWluXSBEb2N1bWVudCByZXdyaXRlOiAke2hvc3RuYW1lfSR7cGF0aG5hbWV9IOKGkiAke3VybC5wYXRobmFtZX1gXG4gICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UucmV3cml0ZSh1cmwsIHtcbiAgICAgICAgICAgICAgICByZXF1ZXN0OiB7IGhlYWRlcnM6IHJlcXVlc3RIZWFkZXJzIH0sXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBIYW5kbGUgL3B1YmxpYyByb3V0ZXMgb24gY3VzdG9tIGRvbWFpbnNcbiAgICAgICAgICAgIGlmIChwYXRobmFtZS5zdGFydHNXaXRoKFwiL3B1YmxpY1wiKSkge1xuICAgICAgICAgICAgICAvLyBJZiBhY2Nlc3NpbmcgL3B1YmxpYy97b3JnRG9tYWlufSBvbiBjdXN0b20gZG9tYWluLCByZWRpcmVjdCB0byByb290XG4gICAgICAgICAgICAgIGlmIChwYXRobmFtZSA9PT0gYC9wdWJsaWMvJHtvcmdEb21haW59YCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFxuICAgICAgICAgICAgICAgICAgYFtDdXN0b20gRG9tYWluXSBSZWRpcmVjdCAvcHVibGljLyR7b3JnRG9tYWlufSDihpIgL2BcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UucmVkaXJlY3QobmV3IFVSTChcIi9cIiwgcmVxLnVybCkpO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgLy8gSWYgYWNjZXNzaW5nIC9wdWJsaWMve29yZ0RvbWFpbn0ve2RvY3VtZW50SWR9LCByZWRpcmVjdCB0byAve2RvY3VtZW50SWR9XG4gICAgICAgICAgICAgIGNvbnN0IHB1YmxpY0RvY1BhdHRlcm4gPSBuZXcgUmVnRXhwKFxuICAgICAgICAgICAgICAgIGBeL3B1YmxpYy8ke29yZ0RvbWFpbi5yZXBsYWNlKFwiLlwiLCBcIlxcXFwuXCIpfS8oW2EtZjAtOV17MjR9KSRgLFxuICAgICAgICAgICAgICAgIFwiaVwiXG4gICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgIGNvbnN0IG1hdGNoID0gcGF0aG5hbWUubWF0Y2gocHVibGljRG9jUGF0dGVybik7XG4gICAgICAgICAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGRvY0lkID0gbWF0Y2hbMV07XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXG4gICAgICAgICAgICAgICAgICBgW0N1c3RvbSBEb21haW5dIFJlZGlyZWN0IC9wdWJsaWMvJHtvcmdEb21haW59LyR7ZG9jSWR9IOKGkiAvJHtkb2NJZH1gXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLnJlZGlyZWN0KG5ldyBVUkwoYC8ke2RvY0lkfWAsIHJlcS51cmwpKTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKFxuICAgICAgICAgICAgICAgIGBbQ3VzdG9tIERvbWFpbl0gUHVibGljIHJvdXRlIHBhc3N0aHJvdWdoOiAke3BhdGhuYW1lfWBcbiAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5yZXdyaXRlKHVybCwge1xuICAgICAgICAgICAgICAgIHJlcXVlc3Q6IHsgaGVhZGVyczogcmVxdWVzdEhlYWRlcnMgfSxcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEFsbG93IEFQSSBjYWxscyBmb3IgcHVibGljIGRhdGFcbiAgICAgICAgICAgIGlmIChwYXRobmFtZS5zdGFydHNXaXRoKFwiL2FwaS9wdWJsaWNcIikpIHtcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coYFtDdXN0b20gRG9tYWluXSBBUEkgcGFzc3Rocm91Z2g6ICR7cGF0aG5hbWV9YCk7XG4gICAgICAgICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UubmV4dCh7XG4gICAgICAgICAgICAgICAgcmVxdWVzdDogeyBoZWFkZXJzOiByZXF1ZXN0SGVhZGVycyB9LFxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gQmxvY2sgYWxsIG90aGVyIHJvdXRlcyBvbiBjdXN0b20gZG9tYWlucyAoYWRtaW4sIGRhc2hib2FyZCwgYXV0aCwgZXRjLilcbiAgICAgICAgICAgIC8vIFVzZXJzIG11c3QgYWNjZXNzIHRoZSBtYWluIGFwcCBkb21haW4gKGVhaXAuZmx5Y2xpbS5jb20pIGZvciB0aGVzZSBmZWF0dXJlc1xuICAgICAgICAgICAgY29uc29sZS5sb2coXG4gICAgICAgICAgICAgIGBDdXN0b20gZG9tYWluICR7Y2xlYW5Eb21haW59IGJsb2NrZWQgYWNjZXNzIHRvOiAke3BhdGhuYW1lfWBcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICByZXR1cm4gbmV3IE5leHRSZXNwb25zZShcbiAgICAgICAgICAgICAgSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICAgIGVycm9yOiBcIkFjY2VzcyBEZW5pZWRcIixcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiBgVGhpcyBjdXN0b20gZG9tYWluIG9ubHkgcHJvdmlkZXMgcHVibGljIGVBSVAgYWNjZXNzLiBGb3IgYWRtaW5pc3RyYXRpb24sIHBsZWFzZSB2aXNpdCB0aGUgbWFpbiBhcHBsaWNhdGlvbiBhdCAke1xuICAgICAgICAgICAgICAgICAgcHJvY2Vzcy5lbnYuTkVYVEFVVEhfVVJMIHx8IFwiaHR0cHM6Ly9lYWlwLmZseWNsaW0uY29tXCJcbiAgICAgICAgICAgICAgICB9YCxcbiAgICAgICAgICAgICAgICBjb2RlOiBcIkNVU1RPTV9ET01BSU5fUFVCTElDX09OTFlcIixcbiAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBzdGF0dXM6IDQwMyxcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7IFwiY29udGVudC10eXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiIH0sXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gRG9tYWluIG5vdCBmb3VuZCBpbiBvdXIgc3lzdGVtXG4gICAgICAgIHJldHVybiBuZXcgTmV4dFJlc3BvbnNlKFxuICAgICAgICAgIEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgIGVycm9yOiBcIkRvbWFpbiBub3QgY29uZmlndXJlZFwiLFxuICAgICAgICAgICAgbWVzc2FnZTogYFRoZSBkb21haW4gJHtjbGVhbkRvbWFpbn0gaXMgbm90IGFzc29jaWF0ZWQgd2l0aCBhbnkgb3JnYW5pemF0aW9uLmAsXG4gICAgICAgICAgICBjb2RlOiBcIkRPTUFJTl9OT1RfRk9VTkRcIixcbiAgICAgICAgICB9KSxcbiAgICAgICAgICB7XG4gICAgICAgICAgICBzdGF0dXM6IDQwNCxcbiAgICAgICAgICAgIGhlYWRlcnM6IHsgXCJjb250ZW50LXR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIgfSxcbiAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiRG9tYWluIGxvb2t1cCBlcnJvcjpcIiwgZXJyb3IpO1xuICAgICAgICByZXR1cm4gbmV3IE5leHRSZXNwb25zZShcbiAgICAgICAgICBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICBlcnJvcjogXCJEb21haW4gbG9va3VwIGZhaWxlZFwiLFxuICAgICAgICAgICAgbWVzc2FnZTogXCJVbmFibGUgdG8gcmVzb2x2ZSBkb21haW4gY29uZmlndXJhdGlvbi5cIixcbiAgICAgICAgICAgIGNvZGU6IFwiRE9NQUlOX0xPT0tVUF9FUlJPUlwiLFxuICAgICAgICAgIH0pLFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIHN0YXR1czogNTAwLFxuICAgICAgICAgICAgaGVhZGVyczogeyBcImNvbnRlbnQtdHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIiB9LFxuICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBNYWluIGRvbWFpbiBoYW5kbGluZyAtIG5vIHNwZWNpYWwgdGVuYW50IHZhbGlkYXRpb24gbmVlZGVkXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5uZXh0KCk7XG4gIH0sXG4gIHtcbiAgICBjYWxsYmFja3M6IHtcbiAgICAgIGF1dGhvcml6ZWQ6ICh7IHRva2VuLCByZXEgfSkgPT4ge1xuICAgICAgICBjb25zdCB7IHBhdGhuYW1lIH0gPSByZXEubmV4dFVybDtcblxuICAgICAgICAvLyBEZWZpbmUgcm91dGUgY2F0ZWdvcmllc1xuICAgICAgICBjb25zdCBwdWJsaWNSb3V0ZXMgPSBbXG4gICAgICAgICAgXCIvcHVibGljXCIsXG4gICAgICAgICAgXCIvZWFpcFwiLFxuICAgICAgICAgIFwiL2FwaS9wdWJsaWNcIixcbiAgICAgICAgICBcIi9hdXRoL3NpZ25pblwiLFxuICAgICAgICAgIFwiL2F1dGgvc2lnbnVwXCIsXG4gICAgICAgICAgXCIvYXV0aC9lcnJvclwiLFxuICAgICAgICAgIFwiL19uZXh0XCIsXG4gICAgICAgICAgXCIvZmF2aWNvbi5pY29cIixcbiAgICAgICAgXTtcblxuICAgICAgICBjb25zdCBwcm90ZWN0ZWRSb3V0ZXMgPSBbXG4gICAgICAgICAgXCIvYWRtaW5cIixcbiAgICAgICAgICBcIi9kYXNoYm9hcmRcIixcbiAgICAgICAgICBcIi9kb2N1bWVudHNcIixcbiAgICAgICAgICBcIi92ZXJzaW9uc1wiLFxuICAgICAgICAgIFwiL2V4cG9ydHNcIixcbiAgICAgICAgICBcIi9wcm9maWxlXCIsXG4gICAgICAgICAgXCIvb3JnYW5pemF0aW9uXCIsXG4gICAgICAgICAgXCIvYXBpL2FkbWluXCIsXG4gICAgICAgICAgXCIvYXBpL2RvY3VtZW50c1wiLFxuICAgICAgICAgIFwiL2FwaS91c2Vyc1wiLFxuICAgICAgICBdO1xuXG4gICAgICAgIC8vIEFsbG93IHB1YmxpYyByb3V0ZXMgd2l0aG91dCBhdXRoZW50aWNhdGlvblxuICAgICAgICBpZiAocHVibGljUm91dGVzLnNvbWUoKHJvdXRlKSA9PiBwYXRobmFtZS5zdGFydHNXaXRoKHJvdXRlKSkpIHtcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENoZWNrIGlmIHJvdXRlIHJlcXVpcmVzIGF1dGhlbnRpY2F0aW9uXG4gICAgICAgIGNvbnN0IHJlcXVpcmVzQXV0aCA9IHByb3RlY3RlZFJvdXRlcy5zb21lKChyb3V0ZSkgPT5cbiAgICAgICAgICBwYXRobmFtZS5zdGFydHNXaXRoKHJvdXRlKVxuICAgICAgICApO1xuXG4gICAgICAgIGlmIChyZXF1aXJlc0F1dGgpIHtcbiAgICAgICAgICAvLyBSZXF1aXJlIHZhbGlkIHRva2VuIGZvciBwcm90ZWN0ZWQgcm91dGVzXG4gICAgICAgICAgaWYgKCF0b2tlbikge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vIEFkZGl0aW9uYWwgcm9sZS1iYXNlZCBjaGVja3NcbiAgICAgICAgICBpZiAocGF0aG5hbWUuc3RhcnRzV2l0aChcIi9hZG1pblwiKSAmJiB0b2tlbi5yb2xlICE9PSBcInN1cGVyX2FkbWluXCIpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIERlZmF1bHQ6IGFsbG93IGFjY2VzcyB0byB1bnNwZWNpZmllZCByb3V0ZXNcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9LFxuICAgIH0sXG4gIH1cbik7XG5cbmV4cG9ydCBjb25zdCBjb25maWcgPSB7XG4gIG1hdGNoZXI6IFtcbiAgICAvKlxuICAgICAqIE1hdGNoIGFsbCByZXF1ZXN0IHBhdGhzIGV4Y2VwdCBmb3IgdGhlIG9uZXMgc3RhcnRpbmcgd2l0aDpcbiAgICAgKiAtIGFwaS9hdXRoIChhdXRoIGVuZHBvaW50cylcbiAgICAgKiAtIF9uZXh0L3N0YXRpYyAoc3RhdGljIGZpbGVzKVxuICAgICAqIC0gX25leHQvaW1hZ2UgKGltYWdlIG9wdGltaXphdGlvbiBmaWxlcylcbiAgICAgKiAtIGZhdmljb24uaWNvIChmYXZpY29uIGZpbGUpXG4gICAgICogLSBwdWJsaWMgZm9sZGVyXG4gICAgICovXG4gICAgXCIvKCg/IWFwaS9hdXRofF9uZXh0L3N0YXRpY3xfbmV4dC9pbWFnZXxmYXZpY29uLmljb3x1cGxvYWRzfGV4cG9ydHN8YXV0aCkuKilcIixcbiAgXSxcbn07XG4iXSwibmFtZXMiOlsid2l0aEF1dGgiLCJOZXh0UmVzcG9uc2UiLCJEb21haW5TZXJ2aWNlIiwibWlkZGxld2FyZSIsInJlcSIsInBhdGhuYW1lIiwibmV4dFVybCIsInRva2VuIiwibmV4dGF1dGgiLCJmb3J3YXJkZWRIb3N0IiwiaGVhZGVycyIsImdldCIsImhvc3RuYW1lIiwiY29uc29sZSIsImxvZyIsImhvc3QiLCJpbmNsdWRlcyIsIm5leHQiLCJjbGVhbkRvbWFpbiIsInRvTG93ZXJDYXNlIiwicmVwbGFjZSIsIm1haW5BcHBEb21haW4iLCJwcm9jZXNzIiwiZW52IiwiTkVYVEFVVEhfVVJMIiwic3BsaXQiLCJpc01haW5Eb21haW4iLCJpbnRlcm5hbE9yaWdpbiIsImRvbWFpbkxvb2t1cFVybCIsIlVSTCIsInNlYXJjaFBhcmFtcyIsInNldCIsInRvU3RyaW5nIiwiZG9tYWluUmVzcG9uc2UiLCJmZXRjaCIsIm9rIiwiZG9tYWluRGF0YSIsImpzb24iLCJzdWNjZXNzIiwib3JnYW5pemF0aW9uIiwicmVxdWVzdEhlYWRlcnMiLCJIZWFkZXJzIiwiX2lkIiwibmFtZSIsInVzZXJPcmdJZCIsIm9yZ2FuaXphdGlvbklkIiwiZG9tYWluT3JnSWQiLCJ2YWxpZGF0ZVVzZXJBY2Nlc3MiLCJzdGFydHNXaXRoIiwibG9naW5VcmwiLCJ1cmwiLCJyZWRpcmVjdCIsImNsb25lIiwib3JnRG9tYWluIiwiZG9tYWluIiwicmV3cml0ZSIsInJlcXVlc3QiLCJkb2N1bWVudElkUGF0dGVybiIsInRlc3QiLCJwdWJsaWNEb2NQYXR0ZXJuIiwiUmVnRXhwIiwibWF0Y2giLCJkb2NJZCIsIkpTT04iLCJzdHJpbmdpZnkiLCJlcnJvciIsIm1lc3NhZ2UiLCJjb2RlIiwic3RhdHVzIiwiY2FsbGJhY2tzIiwiYXV0aG9yaXplZCIsInB1YmxpY1JvdXRlcyIsInByb3RlY3RlZFJvdXRlcyIsInNvbWUiLCJyb3V0ZSIsInJlcXVpcmVzQXV0aCIsInJvbGUiLCJjb25maWciLCJtYXRjaGVyIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(middleware)/./src/middleware.ts\n");

/***/ })

});